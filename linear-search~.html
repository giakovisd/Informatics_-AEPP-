<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î£ÎµÎ¹ÏÎ¹Î±ÎºÎ® Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</title>
    <style>
        :root {
            --bg-color: #f8fafc;
            --text-color: #1e293b;
            --panel-bg: #ffffff;
            --highlight-line: #fde047;
            --array-item-bg: #3b82f6;
            --array-item-text: #ffffff;
            --compare-color: #f59e0b; /* Orange for checking */
            --found-color: #10b981;   /* Green for found */
            --not-found-color: #ef4444; /* Red for mismatch */
            --border-color: #cbd5e1;
            --arrow-color: #dc2626;
            --disabled-btn: #94a3b8;
        }

        body.dark-mode {
            --bg-color: #0f172a;
            --text-color: #f1f5f9;
            --panel-bg: #1e293b;
            --highlight-line: #475569;
            --array-item-bg: #2563eb;
            --border-color: #334155;
            --arrow-color: #f87171;
            --disabled-btn: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Header --- */
        header {
            background-color: var(--panel-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            box-sizing: border-box;
            flex-shrink: 0;
            z-index: 100;
        }

        .header-title h1 { margin: 0; font-size: 1.1rem; }
        .controls-area { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }

        input[type="text"] {
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: 140px;
            font-family: inherit;
            font-size: 0.9rem;
        }

        button {
            padding: 8px 14px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            background-color: var(--panel-bg);
            color: var(--text-color);
            transition: all 0.2s;
            white-space: nowrap;
        }
        button.primary { background-color: var(--array-item-bg); color: white; border: none; }
        button:hover:not(:disabled) { filter: brightness(0.95); transform: translateY(-1px); }
        button:disabled { background-color: var(--disabled-btn); color: #ccc; cursor: not-allowed; }

        .slider-container { display: flex; align-items: center; gap: 5px; font-size: 0.8rem; margin-left: 10px; }

        /* --- Main Layout --- */
        .main-container {
            display: flex;
            flex: 1;
            padding: 15px;
            gap: 15px;
            height: calc(100% - 70px);
            box-sizing: border-box;
        }

        /* LEFT: Code Panel */
        .col-code {
            flex: 0 0 420px;
            display: flex;
            flex-direction: column;
            background: var(--panel-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .tabs { 
            display: flex; 
            background: #f1f5f9; 
            border-bottom: 1px solid var(--border-color);
        }
        .tab {
            flex: 1;
            text-align: center; padding: 12px; font-size: 0.9rem; cursor: pointer;
            border-bottom: 3px solid transparent; color: #64748b;
        }
        .tab:hover { background: #e2e8f0; }
        .tab.active { background: var(--panel-bg); border-bottom-color: var(--array-item-bg); color: var(--text-color); font-weight: bold; }

        .code-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .code-line { padding: 2px 6px; border-radius: 3px; }
        .code-line.active { background-color: var(--highlight-line); color: #000; font-weight: bold; }

        .note-box {
            background-color: #fffbeb;
            border-top: 1px solid #fcd34d;
            padding: 15px;
            font-size: 0.85rem;
            color: #92400e;
            display: none; /* Hidden by default */
        }
        .note-box.visible { display: block; }
        .note-box ul { margin: 5px 0 0 20px; padding: 0; }

        /* CENTER: Visualization */
        .col-viz {
            flex: 1;
            background: var(--panel-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 15px;
            position: relative;
        }

        .narrative {
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(16, 185, 129, 0.1); 
            border-left: 4px solid var(--found-color);
            font-size: 0.95rem;
            font-style: italic;
            min-height: 24px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }

        .arrays-wrapper {
            flex: 1;
            display: flex;
            justify-content: center;
            gap: 100px; 
            overflow-y: auto; 
            align-items: flex-start;
            padding-top: 10px;
            padding-bottom: 40px;
            padding-left: 140px; /* Space for pointers */
        }

        .array-col { display: flex; flex-direction: column; align-items: center; position: relative; }
        
        .array-header { 
            font-weight: bold; 
            height: 40px; 
            display: flex; 
            align-items: center; 
            font-size: 1rem; 
            color: var(--text-color); 
        }

        .cell-wrapper {
            position: relative;
            height: 38px;
            width: 140px;
            margin-bottom: 6px; 
        }

        .cell {
            width: 100%;
            height: 100%;
            background-color: var(--array-item-bg);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            box-sizing: border-box;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            transition: background-color 0.3s;
        }

        .cell-idx { position: absolute; left: -25px; font-size: 0.75rem; color: var(--text-color); opacity: 0.7; font-weight: bold; top: 10px; }
        
        /* States */
        .comparing { background-color: var(--compare-color) !important; transform: scale(1.05); z-index: 5; }
        .found { background-color: var(--found-color) !important; transform: scale(1.1); font-weight: bold; z-index: 6; }
        .not-found-anim { animation: shake 0.4s; background-color: var(--not-found-color) !important; }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* --- POINTERS --- */
        .pointer-track {
            position: absolute;
            left: -130px; 
            top: 40px; 
            width: 100px;
            height: 100%;
            pointer-events: none;
        }
        
        .sliding-pointer {
            position: absolute;
            top: 0;
            right: 0;
            height: 38px; 
            display: flex;
            align-items: center; 
            justify-content: flex-end;
            gap: 5px;
            transition: top 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            opacity: 1;
        }

        .pointer-arrow-symbol { font-size: 1.5rem; color: var(--arrow-color); line-height: 0; font-weight: bold; padding-bottom: 2px; }
        .pointer-label { font-size: 1.1rem; font-weight: bold; color: var(--arrow-color); font-family: monospace; }

        /* RIGHT: Output */
        .col-output {
            flex: 0 0 200px;
            background: var(--panel-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color)
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .output-header { padding: 10px; background: #f1f5f9; font-weight: bold; border-bottom: 1px solid var(--border-color); }
        .output-log { flex: 1; padding: 10px; overflow-y: auto; font-family: monospace; font-size: 0.85rem; }
        .log-item { border-bottom: 1px solid #eee; padding: 3px 0; }
/* ÎšÎ»Î¬ÏƒÎ· Î³Î¹Î± Î½Î± ÎºÏÏÎ²ÎµÎ¹ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± */
.col-code.hidden {
    display: none;
}
    </style>
</head>
<body>

<header>
    <div class="header-title">
        <h1>Î£ÎµÎ¹ÏÎ¹Î±ÎºÎ® Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</h1>
    </div>
    
    <div class="controls-area">
        <input type="text" id="searchInput" placeholder="ÎŒÎ½Î¿Î¼Î±..." value="">
        <button onclick="resetSim()">ğŸ”„ Î‘ÏÏ‡Î®</button>
        <button onclick="play()" id="btnPlay" class="primary">â–¶ï¸ Î•ÎºÏ„Î­Î»ÎµÏƒÎ·</button>
        <button onclick="step()" id="btnStep">Î’Î®Î¼Î± â©</button>
        <button onclick="toggleCode()" id="btnCode">ğŸ‘ï¸ ÎšÏÎ´Î¹ÎºÎ±Ï‚</button>
        
        <div class="slider-container">
            <span>Î¤Î±Ï‡ÏÏ„Î·Ï„Î±:</span>
            <input type="range" min="50" max="1500" value="800" id="speedSlider" oninput="updateSpeed()">
        </div>

        <button onclick="toggleTheme()" id="btnTheme">ğŸŒ™</button>
    </div>
</header>

<div class="main-container">
    
    <div class="col-code">
        <div class="tabs">
            <div class="tab active" onclick="setSolution(1)" id="t1">Î›ÏÏƒÎ· 1 (Î Î»Î®ÏÎ·Ï‚ Î£Î¬ÏÏ‰ÏƒÎ·)</div>
            <div class="tab" onclick="setSolution(2)" id="t2">Î›ÏÏƒÎ· 2 (Î”Î¹Î±ÎºÎ¿Ï€Î® ÏŒÏ„Î±Î½ Î²ÏÎµÎ¸ÎµÎ¯)</div>
        </div>
        <div class="code-content" id="codeContainer"></div>
        
        <div class="note-box" id="sol1Note">
            <strong>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·:</strong> Î¤Î¿Î½ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿ Ï„Î¿Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Ï, ÏŒÏ„Î±Î½ Î¼Î¿Ï… Î¶Î·Ï„Î¿ÏÎ½:
            <ul>
                <li>1. Î ÏŒÏƒÎµÏ‚ Ï†Î¿ÏÎ­Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„Î¿ x ÏƒÏ„Î¿Î½ Î‘</li>
                <li>2. Î£Îµ Ï€Î¿Î¹ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹.</li>
            </ul>
        </div>
    </div>

    <div class="col-viz">
        <div class="narrative" id="narrativeBox">Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Î¹ Ï€Î±Ï„Î®ÏƒÏ„Îµ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·...</div>
        
        <div class="arrays-wrapper" id="arraysContainer">
            </div>
    </div>

    <div class="col-output">
        <div class="output-header">ğŸ“º ÎŸÎ¸ÏŒÎ½Î· Î•Î¾ÏŒÎ´Î¿Ï…</div>
        <div class="output-log" id="outputLog"></div>
    </div>

</div>

<script>
    // --- Data Pool for Random Names ---
    const NAME_POOL = [
        "Î“Î¹ÏÏÎ³Î¿Ï‚", "ÎœÎ±ÏÎ¯Î±", "Î”Î·Î¼Î®Ï„ÏÎ·Ï‚", "Î•Î»Î­Î½Î·", "ÎšÏÏƒÏ„Î±Ï‚", "Î†Î½Î½Î±", 
        "Î“Î¹Î¬Î½Î½Î·Ï‚", "Î£Î¿Ï†Î¯Î±", "ÎÎ¯ÎºÎ¿Ï‚", "ÎšÎ±Ï„ÎµÏÎ¯Î½Î±", "Î Î±ÏÎ»Î¿Ï‚", "Î’Î±ÏƒÎ¹Î»Î¹ÎºÎ®",
        "Î‘Î½Î´ÏÎ­Î±Ï‚", "Î”Î®Î¼Î·Ï„ÏÎ±", "Î˜Î±Î½Î¬ÏƒÎ·Ï‚", "Î§ÏÎ¹ÏƒÏ„Î¯Î½Î±", "Î’Î±Î³Î³Î­Î»Î·Ï‚", "Î™Ï‰Î¬Î½Î½Î±",
        "ÎœÎ¬ÏÎ¹Î¿Ï‚", "Î‘Î»ÎµÎ¾Î¬Î½Î´ÏÎ±", "Î£Ï€ÏÏÎ¿Ï‚", "Î“ÎµÏ‰ÏÎ³Î¯Î±", "Î Î­Ï„ÏÎ¿Ï‚", "Î•Î¹ÏÎ®Î½Î·",
        "Î‘Î½Ï„ÏÎ½Î·Ï‚", "Î–Ï‰Î®", "Î—Î»Î¯Î±Ï‚", "Î‘Î³Î³ÎµÎ»Î¹ÎºÎ®", "Î£Ï„Î­Ï†Î±Î½Î¿Ï‚", "ÎœÏ…ÏÏ„Ï"
    ];

    // --- Code Variants ---
    const SOL_CODES = {
        1: [
            "Î”Î¹Î¬Î²Î±ÏƒÎµ x",
            "done â† Î¨Î•Î¥Î”Î—Î£",
            "Î“Î¹Î± i Î±Ï€ÏŒ 1 Î¼Î­Ï‡ÏÎ¹ 12",
            "  Î‘Î½ ÎŸÎ[i] = x Ï„ÏŒÏ„Îµ",
            "    done â† Î‘Î»Î·Î¸Î®Ï‚",
            "  Ï„Î­Î»Î¿Ï‚_Î±Î½",
            "Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚",
            "Î‘Î½ done = Î‘Î»Î·Î¸Î®Ï‚ Ï„ÏŒÏ„Îµ",
            "  Î“ÏÎ¬ÏˆÎµ 'Î’Î¡Î•Î˜Î—ÎšÎ•'",
            "Î±Î»Î»Î¹ÏÏ‚",
            "  Î“ÏÎ¬ÏˆÎµ 'Î”Î•Î Î’Î¡Î•Î˜Î—ÎšÎ•'",
            "Î¤Î­Î»Î¿Ï‚_Î±Î½"
        ],
        2: [
            "Î”Î¹Î¬Î²Î±ÏƒÎµ x",
            "done â† Î¨Î•Î¥Î”Î—Î£",
            "i â† 1",
            "ÎŒÏƒÎ¿ i â‰¤ 12 ÎºÎ±Î¹ done = Î¨ÎµÏ…Î´Î®Ï‚ ÎµÏ€Î±Î½Î¬Î»Î±Î²Îµ",
            "  Î‘Î½ ÎŸÎ[i] = x Ï„ÏŒÏ„Îµ",
            "    done â† Î‘Î»Î·Î¸Î®Ï‚",
            "    Î˜ â† i",
            "  Î±Î»Î»Î¹ÏÏ‚",
            "    i â† i + 1",
            "  Ï„Î­Î»Î¿Ï‚_Î±Î½",
            "Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚",
            "Î‘Î½ done = Î‘Î»Î·Î¸Î®Ï‚ Ï„ÏŒÏ„Îµ",
            "  Î“ÏÎ¬ÏˆÎµ 'Î’Î¡Î•Î˜Î—ÎšÎ•', Î˜",
            "Î±Î»Î»Î¹ÏÏ‚",
            "  Î“ÏÎ¬ÏˆÎµ 'Î”Î•Î Î’Î¡Î•Î˜Î—ÎšÎ•'",
            "Î¤Î­Î»Î¿Ï‚_Î±Î½"
        ]
    };

    // --- State ---
    let currentSol = 1;
    let data = [];
    let steps = [];
    let stepIdx = -1;
    let timer = null;
    let isPlaying = false;
    let speed = 800;
    let targetName = "";

    const STEP_HEIGHT = 44; // Cell 38 + Margin 6
    const HEADER_OFFSET = -40; 

    // Helper to shuffle array
    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    // --- Init ---
    function init() {
        // Randomize Names each time
        data = shuffle([...NAME_POOL]).slice(0, 12);
        
        // Pick a random name from the data to populate the search box initially for convenience
        // or leave it blank/default as requested. User can change it.
        // Let's set a default valid one so the user sees a "found" case easily first.
        const randomExisting = data[Math.floor(Math.random() * data.length)];
        // Only set if input is empty or we just reloaded page, 
        // but user asked for "random names every time code runs".
        // Let's preserve user input if it exists, otherwise random.
        const inputEl = document.getElementById('searchInput');
        if(!inputEl.value) inputEl.value = randomExisting;

        renderCode();
        renderArray();
        updatePointers(-1);
        document.getElementById('sol1Note').classList.toggle('visible', currentSol === 1);
    }

    function setSolution(n) {
        currentSol = n;
        document.querySelectorAll('.tab').forEach((t, i) => {
            t.classList.toggle('active', i+1 === n);
        });
        resetSim();
    }

    function resetSim() {
        isPlaying = false;
        clearTimeout(timer);
        stepIdx = -1;
        document.getElementById('outputLog').innerHTML = '';
        document.getElementById('narrativeBox').innerText = "Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Î¹ Ï€Î±Ï„Î®ÏƒÏ„Îµ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·...";
        document.getElementById('narrativeBox').style.backgroundColor = "";
        document.getElementById('narrativeBox').style.borderLeftColor = "";
        document.getElementById('btnPlay').innerText = "â–¶ï¸ Î•ÎºÏ„Î­Î»ÎµÏƒÎ·";
        document.querySelectorAll('.active').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.cell').forEach(e => {
            e.classList.remove('comparing', 'found', 'not-found-anim');
        });
        
        init();
    }

    // --- Rendering ---
    function renderCode() {
        const lines = SOL_CODES[currentSol];
        const html = lines.map((l, i) => 
            `<div class="code-line" id="line-${i}">
                <span style="color:#888; margin-right:8px; user-select:none;">${i+1}</span>
                ${l.replace(/ /g, '&nbsp;')}
             </div>`
        ).join('');
        document.getElementById('codeContainer').innerHTML = html;
    }

    function renderArray() {
        const con = document.getElementById('arraysContainer');
        let html = '';

        html += `<div class="array-col">
                    <div class="array-header">Î Î¯Î½Î±ÎºÎ±Ï‚ ÎŸÎ</div>
                    <div class="pointer-track" id="track-A">
                        <div id="ptr-i" class="sliding-pointer" style="display:none; top: ${HEADER_OFFSET}px;">
                            <span class="pointer-label">i</span>
                            <span class="pointer-arrow-symbol">â¡</span>
                        </div>
                    </div>`;
        data.forEach((v, i) => html += createCell(i, v));
        html += `</div>`;

        con.innerHTML = html;
    }

    function createCell(idx, val) {
        return `
            <div class="cell-wrapper" id="wrap-${idx}">
                <div id="c-${idx}" class="cell">
                    <span class="cell-idx">${idx+1}</span>
                    <span class="cell-val">${val}</span>
                </div>
            </div>
        `;
    }

    // --- Logic Generation ---
    function calcSteps() {
        steps = [];
        targetName = document.getElementById('searchInput').value.trim();
        if(!targetName) targetName = "ÎšÎµÎ½ÏŒ";

        // Read X
        steps.push({ line: 0, type: 'info', msg: `Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î±: "${targetName}"` });

        if (currentSol === 1) {
            // Solution 1: For Loop
            steps.push({ line: 1, type: 'info', msg: 'done â† Î¨Î•Î¥Î”Î—Î£' });
            let done = false;
            
            for(let i=0; i<12; i++) {
                steps.push({ line: 2, type: 'loop', i: i, msg: `ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ i=${i+1}` });
                steps.push({ line: 3, type: 'cmp', i: i, msg: `ÎŸÎ[${i+1}] = ${targetName};` });

                if(data[i].toLowerCase() === targetName.toLowerCase()) {
                    done = true;
                    steps.push({ line: 4, type: 'found', i: i, msg: 'Î’ÏÎ­Î¸Î·ÎºÎµ! done â† Î‘Î»Î·Î¸Î®Ï‚' });
                } else {
                    steps.push({ line: 3, type: 'not-found', i: i, msg: 'Î”ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿.' });
                }
            }

            steps.push({ line: 7, type: 'check-done', msg: `ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚: done = ${done ? 'Î‘Î»Î·Î¸Î®Ï‚' : 'Î¨ÎµÏ…Î´Î®Ï‚'}` });
            if(done) {
                steps.push({ line: 8, type: 'print', val: 'Î’Î¡Î•Î˜Î—ÎšÎ•', msg: 'Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚' });
            } else {
                steps.push({ line: 10, type: 'print', val: 'Î”Î•Î Î’Î¡Î•Î˜Î—ÎšÎ•', msg: 'Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚' });
            }
            // Highlight Last End If
            steps.push({ line: 11, type: 'finish', msg: 'Î¤Î­Î»Î¿Ï‚ Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚' });

        } else {
            // Solution 2: While Loop
            steps.push({ line: 1, type: 'info', msg: 'done â† Î¨Î•Î¥Î”Î—Î£' });
            steps.push({ line: 2, type: 'info', msg: 'i â† 1', i: 0 }); 
            
            let done = false;
            let i = 0; 
            let posTheta = -1;

            while (i < 12 && !done) {
                steps.push({ line: 3, type: 'loop', i: i, msg: `i=${i+1} ÎºÎ±Î¹ done=Î¨ÎµÏ…Î´Î®Ï‚` });
                steps.push({ line: 4, type: 'cmp', i: i, msg: `ÎŸÎ[${i+1}] = ${targetName};` });

                if(data[i].toLowerCase() === targetName.toLowerCase()) {
                    done = true;
                    posTheta = i + 1;
                    steps.push({ line: 5, type: 'found', i: i, msg: 'Î’ÏÎ­Î¸Î·ÎºÎµ! done â† Î‘Î»Î·Î¸Î®Ï‚' });
                    steps.push({ line: 6, type: 'info', i: i, msg: `Î˜ â† ${posTheta}` });
                } else {
                    steps.push({ line: 7, type: 'not-found', i: i, msg: 'Î”ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿. i â† i + 1' });
                    steps.push({ line: 8, type: 'info', i: i+1, msg: `i â† ${i+2}` }); // Move pointer
                }
                i++; 
            }
            
            steps.push({ line: 11, type: 'check-done', msg: `ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚: done = ${done ? 'Î‘Î»Î·Î¸Î®Ï‚' : 'Î¨ÎµÏ…Î´Î®Ï‚'}` });
            if(done) {
                steps.push({ line: 12, type: 'print', val: `Î’Î¡Î•Î˜Î—ÎšÎ•, Î˜Î­ÏƒÎ·: ${posTheta}`, msg: 'Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚' });
            } else {
                steps.push({ line: 14, type: 'print', val: 'Î”Î•Î Î’Î¡Î•Î˜Î—ÎšÎ•', msg: 'Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î¿Ï‚' });
            }
            // Highlight Last End If
            steps.push({ line: 15, type: 'finish', msg: 'Î¤Î­Î»Î¿Ï‚ Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚' });
        }
    }

    // --- Pointers ---
    function updatePointers(i) {
        const el = document.getElementById('ptr-i');
        
        if (i < 0 || i >= 12) {
             // If i goes out of bounds (13), maybe hide or show at bottom?
             // For simplicity, hide if -1, otherwise limit visual clamp
             if (i<0) el.style.display = 'none';
             else {
                 el.style.display = 'flex';
                 // If i > 11, show it past the array?
                 const topPos = i * STEP_HEIGHT;
                 requestAnimationFrame(() => {
                    el.style.top = topPos + 'px';
                 });
             }
        } else {
            el.style.display = 'flex';
            const topPos = i * STEP_HEIGHT;
            requestAnimationFrame(() => {
                el.style.top = topPos + 'px';
            });
        }
    }

    // --- Execution ---
    function step() {
        if (stepIdx === -1 && steps.length === 0) calcSteps();
        
        if (stepIdx >= steps.length - 1) {
            isPlaying = false;
            document.getElementById('btnPlay').innerText = "â–¶ï¸ Î•ÎºÏ„Î­Î»ÎµÏƒÎ·";
            return;
        }
        stepIdx++;
        runStep(steps[stepIdx]);
    }

    function runStep(s) {
        // Highlight Code
        document.querySelectorAll('.code-line').forEach(e => e.classList.remove('active'));
        if (s.line !== undefined) {
             const lineEl = document.getElementById(`line-${s.line}`);
             if(lineEl) lineEl.classList.add('active');
        }

        // Narrative
        const narr = document.getElementById('narrativeBox');
        if(s.msg) narr.innerText = s.msg;

        // Reset visual states (keep found permanently until reset)
        document.querySelectorAll('.cell').forEach(e => e.classList.remove('comparing', 'not-found-anim'));
        
        // Pointers
        if (s.i !== undefined) updatePointers(s.i);

        // Actions
        if (s.type === 'cmp') {
            const cell = document.getElementById(`c-${s.i}`);
            cell.classList.add('comparing');
            cell.scrollIntoView({behavior: "smooth", block: "center"});
            narr.style.backgroundColor = "rgba(245, 158, 11, 0.1)";
            narr.style.borderLeftColor = "var(--compare-color)";
        } 
        else if (s.type === 'found') {
            const cell = document.getElementById(`c-${s.i}`);
            cell.classList.remove('comparing');
            cell.classList.add('found');
            narr.style.backgroundColor = "rgba(16, 185, 129, 0.1)";
            narr.style.borderLeftColor = "var(--found-color)";
        }
        else if (s.type === 'not-found') {
            const cell = document.getElementById(`c-${s.i}`);
            cell.classList.remove('comparing');
            cell.classList.add('not-found-anim');
            narr.style.backgroundColor = "rgba(239, 68, 68, 0.1)";
            narr.style.borderLeftColor = "var(--not-found-color)";
        }
        else if (s.type === 'print') {
            const log = document.getElementById('outputLog');
            log.innerHTML += `<div class="log-item">${s.val}</div>`;
            log.scrollTop = log.scrollHeight;
        }
        else if (s.type === 'finish') {
            narr.style.backgroundColor = "#f3f4f6";
            narr.style.borderLeftColor = "#6b7280";
        }

        if (isPlaying) {
            timer = setTimeout(step, speed);
        }
    }

    function play() {
        if (!isPlaying) {
            isPlaying = true;
            document.getElementById('btnPlay').innerText = "â¸ Î Î±ÏÏƒÎ·";
            if(stepIdx === -1) calcSteps();
            step();
        } else {
            isPlaying = false;
            clearTimeout(timer);
            document.getElementById('btnPlay').innerText = "â–¶ï¸ Î•ÎºÏ„Î­Î»ÎµÏƒÎ·";
        }
    }

    function updateSpeed() {
        speed = 1550 - document.getElementById('speedSlider').value;
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
    }

    // Initialize first time
    init();
function toggleCode() {
    const codePanel = document.querySelector('.col-code');
    codePanel.classList.toggle('hidden');
    
    // Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ: Î‘Î»Î»Î¬Î¶ÎµÎ¹ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï„Î¿Ï… ÎºÎ¿Ï…Î¼Ï€Î¹Î¿Ï Î±Î½ Î¸ÎµÏ‚
    const btn = document.getElementById('btnCode');
    if (codePanel.classList.contains('hidden')) {
        btn.innerText = "ğŸ‘ï¸ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎšÏÎ´Î¹ÎºÎ±";
    } else {
        btn.innerText = "ğŸ‘ï¸ Î‘Ï€ÏŒÎºÏÏ…ÏˆÎ· ÎšÏÎ´Î¹ÎºÎ±";
    }
}
</script>
</body>
</html>