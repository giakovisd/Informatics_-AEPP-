<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î®: Î“Î™Î‘ &rarr; ÎŸÎ£ÎŸ</title>
    <style>
        :root {
            --bg-color: #f1f5f9;       
            --panel-bg: #ffffff;       
            --text-color: #1e293b;
            --border-color: #cbd5e1;   
            
            --col-keyword: #2563eb; 
            --col-var: #0f172a; 
            --col-num: #d97706;  
            
            --highlight-bg: #fef08a; 
            --flyer-color: #ea580c; 
            
            --active-tab-bg: #2563eb;
            --active-tab-text: #ffffff;
        }

        body.dark-mode {
            --bg-color: #0f172a;
            --panel-bg: #1e293b;
            --text-color: #f1f5f9;
            --border-color: #334155;
            --col-keyword: #60a5fa;
            --col-var: #e2e8f0;
            --col-num: #fbbf24;
            --highlight-bg: #422006;
            --flyer-color: #f97316;
            --active-tab-bg: #60a5fa;
        }

        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; background: var(--bg-color); color: var(--text-color); overflow: hidden; font-size: 0.95rem; }

        /* HEADER */
        header {
            height: 60px; background: var(--panel-bg); border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center; padding: 0 20px; flex-shrink: 0; z-index: 100;
        }
        h1 { font-size: 1.2rem; margin: 0; display:flex; align-items:center; gap:10px; }
        
        .controls { display: flex; gap: 8px; align-items: center; }
        
        button {
            padding: 6px 14px; border: 1px solid var(--border-color); border-radius: 6px;
            cursor: pointer; font-weight: 600; font-size: 0.9rem;
            background: var(--panel-bg); color: var(--text-color); display: flex; align-items: center; gap: 6px;
            transition: all 0.2s; white-space: nowrap;
        }
        button:hover { filter: brightness(0.95); transform: translateY(-1px); }
        button:disabled { opacity: 0.5; cursor: default; transform: none; filter: grayscale(1); }
        
        .btn-run { background: #10b981; color: white; border-color: #059669; }
        .btn-step { background: #3b82f6; color: white; border-color: #2563eb; }
        .btn-reset { background: #ef4444; color: white; border-color: #dc2626; }

        .speed-control { display: flex; align-items: center; gap: 5px; font-size: 0.8rem; margin: 0 10px; background: var(--panel-bg); padding: 4px 8px; border-radius: 6px; border: 1px solid var(--border-color); }
        input[type=range] { width: 100px; cursor: pointer; }

        /* MAIN LAYOUT */
        .container { display: flex; flex: 1; overflow: hidden; position: relative; }

        /* LEFT: Instructions */
        .col-left {
            width: 320px; 
            padding: 20px; 
            border-right: 1px solid var(--border-color); 
            background: var(--panel-bg); 
            overflow-y: auto; line-height: 1.5; font-size: 0.9rem; flex-shrink: 0;
        }
        .info-box {
            background: var(--bg-color); padding: 12px; border-radius: 6px; border: 1px solid var(--border-color); border-left: 4px solid var(--col-keyword); margin-bottom: 15px;
        }

        /* CENTER: Stage */
        .col-center {
            flex: 1; padding: 20px; background: var(--bg-color); overflow: hidden; 
            display: flex; flex-direction: column; align-items: center; position: relative;
        }

        .tabs { display: flex; gap: 10px; margin-bottom: 15px; background: var(--panel-bg); padding: 5px; border-radius: 8px; border: 1px solid var(--border-color); }
        .tab-btn {
            border: none; background: transparent; padding: 8px 16px; cursor: pointer; font-weight: bold; border-radius: 6px; color: var(--text-color); font-size: 0.9rem;
        }
        .tab-btn.active { background-color: var(--active-tab-bg); color: var(--active-tab-text); }

        /* CODE AREA */
        .stage-scroll {
            width: 100%; height: 100%; overflow: auto; display: flex; justify-content: center; align-items: flex-start;
        }
        .stage-area {
            display: flex; flex-direction: row; justify-content: center; align-items: flex-start; gap: 25px; 
            padding: 10px; padding-bottom: 60px;
        }

        .code-card {
            background: var(--panel-bg); padding: 20px; border-radius: 8px; 
            border: 1px solid var(--border-color); 
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            font-family: 'Consolas', monospace; font-size: 1.05rem; line-height: 1.8;
            position: relative; white-space: nowrap; 
        }
        
        .card-src { min-width: 420px; } 
        .card-tgt { min-width: 300px; } 

        .card-title {
            font-size: 0.9rem; font-weight: bold; margin-bottom: 10px; color: var(--text-color); 
            border-bottom: 1px solid var(--border-color); padding-bottom: 5px; text-align: center; opacity: 0.8;
        }

        .line { display: block; padding: 2px 5px; border-radius: 4px; }
        .line.active { background-color: var(--highlight-bg); border-left: 3px solid #f59e0b; }

        .kw { color: var(--col-keyword); font-weight: bold; }
        .var { color: var(--col-var); }
        .num { color: var(--col-num); font-weight: bold; display: inline-block; }
        
        /* Operator Style + Animation */
        .op { margin: 0 4px; display: inline-block; transition: transform 0.2s; }
        
        @keyframes pulseOp {
            0% { transform: scale(1); color: inherit; }
            50% { transform: scale(2.5); color: #dc2626; font-weight: bold; } /* Big and Red */
            100% { transform: scale(1); color: inherit; }
        }
        .pulsate { animation: pulseOp 1.2s ease-in-out; }

        .token { 
            display: inline-block; padding: 0 4px; border-radius: 4px; border: 1px solid transparent; 
            transition: background 0.2s;
        }
        .token.highlight { background: var(--highlight-bg); border-color: var(--col-num); transform: scale(1.1); }
        
        .placeholder {
            display: inline-block; min-width: 30px; border-bottom: 2px dashed #94a3b8; text-align: center; color: transparent; margin: 0 3px;
        }
        .placeholder.filled {
            border-bottom: none; color: var(--col-num); font-weight: bold; animation: popIn 0.4s;
        }
        .placeholder.hidden { display: none; }
        
        @keyframes popIn { 0% { transform: scale(0); } 80% { transform: scale(1.2); } 100% { transform: scale(1); } }

        .flyer {
            position: fixed; z-index: 1000; 
            font-family: 'Consolas', monospace; font-weight: bold; font-size: 1.3rem;
            color: white; background: var(--flyer-color);
            padding: 4px 10px; border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); pointer-events: none;
            transition-timing-function: cubic-bezier(0.45, 0, 0.55, 1);
        }

        /* RIGHT: Progress */
        .col-right {
            width: 240px; 
            background: var(--panel-bg); 
            border-left: 1px solid var(--border-color); 
            display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;
        }
        
        .status-steps { list-style: none; padding: 0; margin: 0; }
        .status-steps li {
            padding: 10px; border-bottom: 1px solid var(--border-color); opacity: 0.5; transition: 0.3s; font-size: 0.9rem;
        }
        .status-steps li.active {
            opacity: 1; font-weight: bold; color: var(--col-keyword); background: var(--bg-color); border-radius: 4px; border-left: 4px solid var(--col-keyword);
        }

        .arrow-separator {
            font-size: 2rem; color: var(--border-color); align-self: center; margin: 0 10px;
        }

    </style>
</head>
<body>

<header>
    <h1>ğŸ¬ ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î®: Î“Î™Î‘ &rarr; ÎŸÎ£ÎŸ</h1>
    <div class="controls">
        <button class="btn-reset" onclick="reset()">ğŸ”„ Î‘ÏÏ‡Î®</button>
        <button class="btn-step" id="btnStep" onclick="manualStep()">ğŸ‘£ Î’Î®Î¼Î±</button>
        <button class="btn-run" id="btnPlay" onclick="togglePlay()">â–¶ Î‘Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®</button>
        
        <div class="speed-control">
            <span>ğŸ¢</span>
            <input type="range" id="speedRange" min="1" max="20" value="10">
            <span>ğŸ‡</span>
        </div>
        <div style="width:1px; background:#ccc; margin:0 5px; height: 20px;"></div>
        <button onclick="document.body.classList.toggle('dark-mode')">ğŸŒ™</button>
    </div>
</header>

<div class="container">
    
    <div class="col-left">
        <h3>ÎŸÎ´Î·Î³Î¯ÎµÏ‚</h3>
        <div id="info-content"></div>
    </div>

    <div class="col-center">
        
        <div class="tabs">
            <button class="tab-btn active" onclick="loadTab(0)">1. Î’Î®Î¼Î± Î˜ÎµÏ„Î¹ÎºÏŒ</button>
            <button class="tab-btn" onclick="loadTab(1)">2. Î’Î®Î¼Î± Î‘ÏÎ½Î·Ï„Î¹ÎºÏŒ</button>
        </div>

        <div class="stage-scroll">
            <div class="stage-area" id="stage">
                </div>
        </div>

    </div>

    <div class="col-right">
        <h4>Î’Î®Î¼Î±Ï„Î±</h4>
        <ul class="status-steps" id="steps-list"></ul>
    </div>

</div>

<script>
    // --- CONTENT DATA ---
    const TAB_INFO = [
        // Tab 1 Text
        `<p>ÎŒÏ„Î±Î½ Î¼Î¿Ï… Î¶Î·Ï„Î¿ÏÎ½ Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÏ‰ Î¼Î¹Î± Î“Î™Î‘ ÏƒÎµ ÎŸÎ£ÎŸ, <b>Ï„Î¿ Î‘Î ÎŸ</b> Ï„Î¼Î®Î¼Î± Ï„Î·Ï‚ Î“Î™Î‘ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ½Ï„Î¿Î»Î® ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·Ï‚ <b>Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€ÏÎ¹Î½</b> Ï„Î·Î½ ÎŸÎ£ÎŸ.</p>
         <p><b>Î¤Î¿ ÎœÎ•_Î’Î—ÎœÎ‘</b> Ï„Î¼Î®Î¼Î± Ï„Î·Ï‚ Î“Î™Î‘, Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ½Ï„Î¿Î»Î® ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·Ï‚, <b>Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€ÏÎ¹Î½</b> Ï„Î¿ <code>Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î±Î»Î·ÏˆÎ·Ï‚</code>.</p>
         <p><u>Î‘Î½ Ï„Î¿ Î²Î®Î¼Î± ÎµÎ¯Î½Î±Î¹ Î¸ÎµÏ„Î¹ÎºÏŒ</u>, Î· ÏƒÏ…Î½Î¸Î®ÎºÎ· Ï„ÎµÏÎ¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï Ï„Î·Ï‚ ÎŸÎ£ÎŸ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï„Î·Ï‚ Î¼Î¿ÏÏ†Î®Ï‚ Ï€.Ï‡. <code>i â‰¤ Ï„ÎµÎ»Î¹ÎºÎ®_Ï„Î¹Î¼Î®</code>.</p>`,
        
        // Tab 2 Text
        `<p>ÎŒÏ„Î±Î½ Î¼Î¿Ï… Î¶Î·Ï„Î¿ÏÎ½ Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÏ‰ Î¼Î¹Î± Î“Î™Î‘ ÏƒÎµ ÎŸÎ£ÎŸ, <b>Ï„Î¿ Î‘Î ÎŸ</b> Ï„Î¼Î®Î¼Î± Ï„Î·Ï‚ Î“Î™Î‘ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ½Ï„Î¿Î»Î® ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·Ï‚ <b>Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€ÏÎ¹Î½</b> Ï„Î·Î½ ÎŸÎ£ÎŸ.</p>
         <p><b>Î¤Î¿ ÎœÎ•_Î’Î—ÎœÎ‘</b> Ï„Î¼Î®Î¼Î± Ï„Î·Ï‚ Î“Î™Î‘, Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ½Ï„Î¿Î»Î® ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·Ï‚, <b>Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€ÏÎ¹Î½</b> Ï„Î¿ <code>Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î±Î»Î·ÏˆÎ·Ï‚</code>.</p>
         <p><u>Î‘Î½ Ï„Î¿ Î²Î®Î¼Î± ÎµÎ¯Î½Î±Î¹ Î±ÏÎ½Î·Ï„Î¹ÎºÏŒ</u>, Î· ÏƒÏ…Î½Î¸Î®ÎºÎ· Ï„ÎµÏÎ¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï Ï„Î·Ï‚ ÎŸÎ£ÎŸ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï„Î·Ï‚ Î¼Î¿ÏÏ†Î®Ï‚ Ï€.Ï‡. <code>i â‰¥ Ï„ÎµÎ»Î¹ÎºÎ®_Ï„Î¹Î¼Î®</code>.</p>`
    ];

    const SCENARIOS = [
        // TAB 1: Positive Step
        {
            src: `
            <div class="line" id="L_for">
                <span class="kw">Î“Î™Î‘</span> <span class="var">Ï‡</span> <span class="kw">Î‘Î ÎŸ</span> <span class="num token" id="s_init">1</span> 
                <span class="kw">ÎœÎ•Î§Î¡Î™</span> <span class="num token" id="s_cond">20</span> 
                <span class="kw">ÎœÎ•_Î’Î—ÎœÎ‘</span> <span class="num token" id="s_step">2</span>
            </div>
            <div class="line" id="L_body" style="padding-left:20px"><span class="kw">Î“Î¡Î‘Î¨Î•</span> <span class="var">Ï‡</span></div>
            <div class="line"><span class="kw">Î¤Î•Î›ÎŸÎ£_Î•Î Î‘ÎÎ‘Î›Î—Î¨Î—Î£</span></div>`,
            
            tgt: `
            <div class="line" id="T_init"><span class="var">Ï‡</span> <span class="op">â†</span> <span class="placeholder" id="t_init">...</span></div>
            <div class="line" id="T_cond"><span class="kw">ÎŸÎ£ÎŸ</span> <span class="var">Ï‡</span> <span class="op" id="tgt_op">&le;</span> <span class="placeholder" id="t_cond">...</span> <span class="kw">Î•Î Î‘ÎÎ‘Î›Î‘Î’Î•</span></div>
            <div class="line" id="T_body" style="padding-left:20px"><span class="kw">Î“Î¡Î‘Î¨Î•</span> <span class="var">Ï‡</span></div>
            <div class="line" id="T_step" style="padding-left:20px"><span class="var">Ï‡</span> <span class="op">â†</span> <span class="var">Ï‡</span> <span class="op">+</span> <span class="placeholder" id="t_step">...</span></div>
            <div class="line"><span class="kw">Î¤Î•Î›ÎŸÎ£_Î•Î Î‘ÎÎ‘Î›Î—Î¨Î—Î£</span></div>`,
            type: 'positive'
        },
        // TAB 2: Negative Step
        {
            src: `
            <div class="line" id="L_for">
                <span class="kw">Î“Î™Î‘</span> <span class="var">Îº</span> <span class="kw">Î‘Î ÎŸ</span> <span class="num token" id="s_init">20</span> 
                <span class="kw">ÎœÎ•Î§Î¡Î™</span> <span class="num token" id="s_cond">1</span> 
                <span class="kw">ÎœÎ•_Î’Î—ÎœÎ‘</span> <span class="num token" id="s_step">-1</span>
            </div>
            <div class="line" id="L_body" style="padding-left:20px"><span class="kw">Î“Î¡Î‘Î¨Î•</span> <span class="var">Îº</span></div>
            <div class="line"><span class="kw">Î¤Î•Î›ÎŸÎ£_Î•Î Î‘ÎÎ‘Î›Î—Î¨Î—Î£</span></div>`,
            
            tgt: `
            <div class="line" id="T_init"><span class="var">Îº</span> <span class="op">â†</span> <span class="placeholder" id="t_init">...</span></div>
            <div class="line" id="T_cond"><span class="kw">ÎŸÎ£ÎŸ</span> <span class="var">Îº</span> <span class="op" id="tgt_op">&ge;</span> <span class="placeholder" id="t_cond">...</span> <span class="kw">Î•Î Î‘ÎÎ‘Î›Î‘Î’Î•</span></div>
            <div class="line" id="T_body" style="padding-left:20px"><span class="kw">Î“Î¡Î‘Î¨Î•</span> <span class="var">Îº</span></div>
            <div class="line" id="T_step" style="padding-left:20px"><span class="var">Îº</span> <span class="op">â†</span> <span class="var">Îº</span> <span class="op">-</span> <span class="placeholder" id="t_step">...</span></div>
            <div class="line"><span class="kw">Î¤Î•Î›ÎŸÎ£_Î•Î Î‘ÎÎ‘Î›Î—Î¨Î—Î£</span></div>`,
            type: 'negative'
        }
    ];

    // --- STATE ---
    let currentTab = 0;
    let steps = [];
    let stepIdx = 0;
    let isPlaying = false;
    let isAnimating = false;
    let timer = null;

    // --- SETUP ---
    function loadTab(idx) {
        currentTab = idx;
        stepIdx = 0;
        isPlaying = false;
        isAnimating = false;
        if(timer) clearTimeout(timer);

        // UI Tabs
        document.querySelectorAll('.tab-btn').forEach((b,i) => b.classList.toggle('active', i===idx));
        document.getElementById('info-content').innerHTML = `<div class="info-box">${TAB_INFO[idx]}</div>`;

        const scen = SCENARIOS[idx];
        document.getElementById('stage').innerHTML = `
            <div class="code-card card-src"><div class="card-title">Î‘Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿Ï‚ (Î“Î™Î‘)</div>${scen.src}</div>
            <div class="arrow-separator">&rarr;</div>
            <div class="code-card card-tgt"><div class="card-title">Î™ÏƒÎ¿Î´ÏÎ½Î±Î¼Î¿ (ÎŸÎ£ÎŸ)</div>${scen.tgt}</div>
        `;

        steps = generateSteps(scen.type);
        renderStepsList();
        
        document.getElementById('btnPlay').innerText = "â–¶ Î‘Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®";
        document.getElementById('btnPlay').disabled = false;
        document.getElementById('btnStep').disabled = false;
    }

    function generateSteps(type) {
        let s = [
            { id:0, text:"1. Î‘ÏÏ‡Î¹ÎºÎ® Î¤Î¹Î¼Î®", srcLine:'L_for', tgtLine:'T_init', srcToken:'s_init', tgtToken:'t_init' },
            // STEP 2: Pulse the Operator!
            { id:1, text:"2. Î£Ï…Î½Î¸Î®ÎºÎ· Î¤ÎµÏÎ¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï", srcLine:'L_for', tgtLine:'T_cond', srcToken:'s_cond', tgtToken:'t_cond', pulseOp: true },
            { id:2, text:"3. Î£ÏÎ¼Î± Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚", action:'reveal_body' },
            { id:3, text:"4. Î’Î®Î¼Î± ÎœÎµÏ„Î±Î²Î¿Î»Î®Ï‚", srcLine:'L_for', tgtLine:'T_step', srcToken:'s_step', tgtToken:'t_step' }
        ];

        if(type === 'negative') {
            s[3].modifier = (val) => Math.abs(parseInt(val));
        }

        s.push({ id:4, text:"ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·", end:true });
        return s;
    }

    function renderStepsList() {
        const ul = document.getElementById('steps-list');
        ul.innerHTML = '';
        steps.forEach((st, i) => {
            let li = document.createElement('li');
            li.id = `li-step-${i}`;
            li.innerText = st.text;
            ul.appendChild(li);
        });
    }

    // --- ANIMATION ---

    function triggerPulse(elId) {
        const el = document.getElementById(elId);
        if(el) {
            el.classList.remove('pulsate');
            void el.offsetWidth; // Force reflow
            el.classList.add('pulsate');
        }
    }

    function flyAsync(srcId, tgtId, modifier) {
        return new Promise(resolve => {
            const srcEl = document.getElementById(srcId);
            const tgtEl = document.getElementById(tgtId);
            
            let txt = srcEl.innerText;
            if(modifier) txt = modifier(txt);

            const flyer = document.createElement('div');
            flyer.className = 'flyer';
            flyer.innerText = txt; 
            
            const r1 = srcEl.getBoundingClientRect();
            const r2 = tgtEl.getBoundingClientRect();

            flyer.style.top = r1.top + 'px';
            flyer.style.left = r1.left + 'px';
            document.body.appendChild(flyer);

            const speedVal = parseInt(document.getElementById('speedRange').value);
            const duration = 2200 - (speedVal * 100); 
            
            flyer.style.transitionDuration = duration + 'ms';

            requestAnimationFrame(() => {
                flyer.style.top = r2.top + 'px';
                flyer.style.left = r2.left + 'px';
                flyer.style.transform = 'scale(1.2)';
            });

            setTimeout(() => {
                flyer.remove();
                tgtEl.innerText = txt;
                tgtEl.classList.add('filled');
                resolve();
            }, duration);
        });
    }

    function revealBodyAsync() {
        return new Promise(resolve => {
            document.getElementById('L_body').classList.add('active');
            const speedVal = parseInt(document.getElementById('speedRange').value);
            const duration = 1500 - (speedVal * 50); 

            setTimeout(() => {
                const tBody = document.getElementById('T_body');
                tBody.style.transition = "background-color 0.5s";
                tBody.style.backgroundColor = getComputedStyle(document.body).getPropertyValue('--highlight-bg');
                
                setTimeout(() => {
                    tBody.style.backgroundColor = "transparent";
                    resolve();
                }, 800);
            }, duration);
        });
    }

    // --- CONTROLLER ---

    async function runStepSequence() {
        if(stepIdx >= steps.length) {
            isPlaying = false;
            document.getElementById('btnPlay').innerText = "Î¤Î­Î»Î¿Ï‚";
            document.getElementById('btnPlay').disabled = true;
            document.getElementById('btnStep').disabled = true;
            return;
        }

        isAnimating = true;
        const currentData = steps[stepIdx];

        document.querySelectorAll('.status-steps li').forEach(li => li.classList.remove('active'));
        document.getElementById(`li-step-${stepIdx}`).classList.add('active');
        
        document.querySelectorAll('.active').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.highlight').forEach(e => e.classList.remove('highlight'));

        if(currentData.action === 'reveal_body') {
            await revealBodyAsync();
        } 
        else if (currentData.srcLine && currentData.tgtToken) {
            // Standard Fly
            document.getElementById(currentData.srcLine).classList.add('active');
            document.getElementById(currentData.srcToken).classList.add('highlight');
            document.getElementById(currentData.tgtLine).classList.add('active'); 
            
            // Check for Pulse Effect
            if(currentData.pulseOp) {
                triggerPulse('tgt_op');
            }

            await flyAsync(currentData.srcToken, currentData.tgtToken, currentData.modifier);
        }

        isAnimating = false;
        stepIdx++;

        if(isPlaying) {
            timer = setTimeout(runStepSequence, 500);
        }
    }

    function togglePlay() {
        if(isAnimating && isPlaying) {
            isPlaying = false;
            document.getElementById('btnPlay').innerText = "â–¶ Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±";
            if(timer) clearTimeout(timer);
        } else if (!isAnimating) {
            isPlaying = true;
            document.getElementById('btnPlay').innerText = "â¸ Î Î±ÏÏƒÎ·";
            runStepSequence();
        } else {
            isPlaying = true;
            document.getElementById('btnPlay').innerText = "â¸ Î Î±ÏÏƒÎ·";
        }
    }

    function manualStep() {
        if(isAnimating) return;
        runStepSequence();
    }

    function reset() {
        loadTab(currentTab);
    }

    // Init
    loadTab(0);

</script>
</body>
</html>