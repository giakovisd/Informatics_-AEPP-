<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î®: ÎŸÎ£ÎŸ &rarr; ÎœÎ•Î§Î¡Î™Î£_ÎŸÎ¤ÎŸÎ¥</title>
    <style>
        :root {
            --bg-color: #f1f5f9;
            --panel-bg: #ffffff;
            --text-color: #1e293b;
            --border-color: #e2e8f0;
            
            --col-keyword: #2563eb; 
            --col-var: #0f172a; 
            --col-val: #d97706;  
            
            --btn-reset: #ef4444;
            --btn-step: #3b82f6;
            --btn-play: #10b981;
            
            --highlight-bg: #fef08a; 
            --flyer-bg: #ffffff;
            --flyer-border: #f59e0b;
        }

        body.dark-mode {
            --bg-color: #0f172a;
            --panel-bg: #1e293b;
            --text-color: #f1f5f9;
            --border-color: #334155;
            --col-keyword: #60a5fa;
            --col-var: #e2e8f0;
            --col-val: #fbbf24;
            --highlight-bg: #422006;
            --flyer-bg: #1e293b;
        }

        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: var(--bg-color); color: var(--text-color); overflow: hidden; }

        /* HEADER */
        header {
            height: 60px; background: var(--panel-bg); border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center; padding: 0 20px; flex-shrink: 0; z-index: 100;
        }
        h1 { font-size: 1.1rem; margin: 0; display:flex; align-items:center; gap:10px; color: var(--text-color); }
        
        .controls { display: flex; gap: 8px; align-items: center; }
        
        button {
            padding: 8px 16px; border: none; border-radius: 6px;
            cursor: pointer; font-weight: 600; font-size: 0.9rem;
            color: white; display: flex; align-items: center; gap: 6px;
            transition: all 0.2s; white-space: nowrap; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button:hover { filter: brightness(1.1); transform: translateY(-1px); }
        button:disabled { opacity: 0.5; cursor: default; transform: none; filter: grayscale(1); }
        
        .btn-reset { background: var(--btn-reset); }
        .btn-step { background: var(--btn-step); }
        .btn-run { background: var(--btn-play); }
        .btn-theme { background: transparent; color: var(--text-color); border: 1px solid var(--border-color); box-shadow: none; padding: 6px 10px;}

        .speed-control { display: flex; align-items: center; gap: 5px; margin: 0 10px; background: var(--panel-bg); padding: 4px 8px; border-radius: 6px; border: 1px solid var(--border-color); }
        input[type=range] { width: 80px; cursor: pointer; }

        /* MAIN LAYOUT (3 Columns) */
        .container { display: flex; flex: 1; overflow: hidden; position: relative; }

        /* LEFT: Instructions */
        .col-left {
            width: 280px; padding: 20px; 
            border-right: 1px solid var(--border-color);
            background: var(--panel-bg); 
            overflow-y: auto; flex-shrink: 0;
        }
        .col-left h3 { margin-top: 0; font-size: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        .info-box {
            background: rgba(37, 99, 235, 0.05); padding: 15px; border-radius: 6px; 
            border-left: 4px solid var(--col-keyword); margin-bottom: 15px; line-height: 1.6; font-size: 0.95rem;
        }

        /* CENTER: Stage */
        .col-center {
            flex: 1; padding: 20px; background: var(--bg-color); overflow: hidden; 
            display: flex; flex-direction: column; align-items: center;
        }

        /* Tabs centered above cards */
        .tabs { 
            display: flex; gap: 10px; margin-bottom: 20px; 
            background: var(--panel-bg); padding: 5px; border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .tab-btn {
            background: transparent; color: var(--text-color); 
            box-shadow: none; border: 1px solid transparent;
            font-size: 0.9rem; padding: 8px 15px;
        }
        .tab-btn:hover { background: rgba(0,0,0,0.05); transform: none; }
        .tab-btn.active { 
            background-color: var(--col-keyword); color: white; 
            box-shadow: 0 2px 4px rgba(37, 99, 235, 0.3);
        }

        /* Code Cards Area */
        .stage-area {
            display: flex; justify-content: center; align-items: flex-start; gap: 30px; 
            width: 100%; overflow: auto; padding-bottom: 20px;
        }

        .code-card {
            background: var(--panel-bg); padding: 0; border-radius: 12px; 
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            font-family: 'Consolas', monospace; font-size: 1.1rem; 
            min-width: 320px; overflow: hidden;
        }

        .card-header {
            background: #f8fafc; border-bottom: 1px solid var(--border-color);
            padding: 10px; text-align: center; font-weight: bold; color: #64748b; font-size: 0.9rem;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        body.dark-mode .card-header { background: #1e293b; color: #94a3b8; }

        .card-body { padding: 20px; line-height: 1.8; min-height: 250px; position: relative; }

        .line { display: block; padding: 2px 8px; border-radius: 4px; transition: background 0.3s; white-space: pre; position: relative; }
        .line.active { background-color: var(--highlight-bg); }
        .line.hidden { opacity: 0; }
        .line.visible { opacity: 1; transition: opacity 0.5s; }

        .kw { color: var(--col-keyword); font-weight: bold; }
        .val { color: var(--col-val); font-weight: bold; }
        
        .arrow-separator {
            font-size: 2rem; color: #cbd5e1; align-self: center; margin-top: 50px;
        }

        /* RIGHT: Steps */
        .col-right {
            width: 250px; background: var(--panel-bg); 
            border-left: 1px solid var(--border-color);
            display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;
        }
        .col-right h4 { margin-top: 0; margin-bottom: 15px; font-size: 1rem; color: var(--text-color); }
        
        .step-list { list-style: none; padding: 0; margin: 0; }
        .step-item {
            padding: 12px 10px; border-bottom: 1px solid var(--border-color); 
            color: #94a3b8; font-size: 0.9rem; transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        .step-item.active {
            color: var(--col-keyword); background: var(--bg-color); 
            border-left-color: var(--col-keyword); font-weight: 600;
            padding-left: 15px;
        }
        .step-item.done { color: #10b981; }

        /* Animation Element */
        .flyer {
            position: fixed; z-index: 1000; pointer-events: none;
            font-family: 'Consolas', monospace; font-size: 1.1rem;
            background: var(--flyer-bg); border: 1px solid var(--flyer-border);
            padding: 4px 8px; border-radius: 4px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

    </style>
</head>
<body>

<header>
    <h1>ğŸ¬ ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î®: ÎŸÎ£ÎŸ &rarr; ÎœÎ•Î§Î¡Î™Î£_ÎŸÎ¤ÎŸÎ¥</h1>
    <div class="controls">
        <button class="btn-reset" onclick="reset()">ğŸ”„ Î‘ÏÏ‡Î®</button>
        <button class="btn-step" id="btnStep" onclick="manualStep()">ğŸ‘£ Î’Î®Î¼Î±</button>
        <button class="btn-run" id="btnPlay" onclick="togglePlay()">â–¶ Î‘Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®</button>
        
        <div class="speed-control">
            <span>ğŸ¢</span>
            <input type="range" id="speedRange" min="1" max="10" value="5">
            <span>ğŸ‡</span>
        </div>
        <button class="btn-theme" onclick="document.body.classList.toggle('dark-mode')">ğŸŒ™</button>
    </div>
</header>

<div class="container">
    
    <div class="col-left">
        <h3>ÎŸÎ´Î·Î³Î¯ÎµÏ‚</h3>
        <div id="info-content"></div>
    </div>

    <div class="col-center">
        <div class="tabs">
            <button class="tab-btn active" onclick="loadTab(0)">1. Î£Î¯Î³Î¿Ï…ÏÎ± Î‘Î»Î·Î¸Î®Ï‚</button>
            <button class="tab-btn" onclick="loadTab(1)">2. ÎŒÏ‡Î¹ Î£Î¯Î³Î¿Ï…ÏÎ± Î‘Î»Î·Î¸Î®Ï‚</button>
        </div>

        <div class="stage-area" id="stage">
            </div>
    </div>

    <div class="col-right">
        <h4>Î’Î®Î¼Î±Ï„Î±</h4>
        <ul class="step-list" id="steps-list">
            </ul>
    </div>

</div>

<script>
    // --- DATA ---
    const TAB_INFO = [
        // Case 1
        `<div class="info-box">
            <p><strong>Î ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· 1:</strong><br>ÎŒÏ„Î±Î½ Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î· ÏƒÏ…Î½Î¸Î®ÎºÎ· ÎµÎ¯Î½Î±Î¹ <u>Î£Î™Î“ÎŸÎ¥Î¡Î‘ Î‘Î›Î—Î˜Î—Î£</u> Ï„Î·Î½ 1Î· Ï†Î¿ÏÎ¬ (Ï€.Ï‡. Ï‰=10 ÎºÎ±Î¹ ÏƒÏ…Î½Î¸Î®ÎºÎ· Ï‰&le;20).</p>
            <p>Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î® Â«Ï„Î¿ÏÎ¼Ï€Î±Â» Ï„Î·Ï‚ Î´Î¿Î¼Î®Ï‚.</p>
         </div>
         <p>Î Î±Ï„Î®ÏƒÏ„Îµ <strong>â–¶ Î‘Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®</strong> Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®.</p>`,
        
        // Case 2
        `<div class="info-box">
            <p><strong>Î ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· 2 (Î“ÎµÎ½Î¹ÎºÎ®):</strong><br>ÎŒÏ„Î±Î½ Î· ÏƒÏ…Î½Î¸Î®ÎºÎ· <u>Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¨Î•Î¥Î”Î—Î£</u> Ï„Î·Î½ 1Î· Ï†Î¿ÏÎ¬ (Ï€.Ï‡. Î”Î¹Î¬Î²Î±ÏƒÎµ Ï‰).</p>
            <p>Î•Ï€ÎµÎ¹Î´Î® Î· ÎœÎ•Î§Î¡Î™Î£_ÎŸÎ¤ÎŸÎ¥ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ Î¼Î¯Î± Ï†Î¿ÏÎ¬, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î·Î½ "Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏÏƒÎ¿Ï…Î¼Îµ" Î²Î¬Î¶Î¿Î½Ï„Î¬Ï‚ Ï„Î· Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± Î´Î¿Î¼Î® <strong>Î‘Î</strong>.</p>
         </div>`
    ];

    const SCENARIOS = [
        // Scenario 1: Simple
        {
            src: [
                { id: 'w1', html: '<span class="var">Ï‰</span> &larr; <span class="val">10</span>' },
                { id: 'w2', html: '<span class="kw">ÎŒÏƒÎ¿</span> <span class="var">Ï‰</span> &le; <span class="val">20</span> <span class="kw">ÎµÏ€Î±Î½Î¬Î»Î±Î²Îµ</span>' },
                { id: 'w3', html: '    <span class="kw">Î“ÏÎ¬ÏˆÎµ</span> <span class="var">Ï‰</span>' },
                { id: 'w4', html: '    <span class="var">Ï‰</span> &larr; <span class="var">Ï‰</span> + <span class="val">1</span>' },
                { id: 'w5', html: '<span class="kw">Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚</span>' }
            ],
            tgt: [
                { id: 'r1', html: '<span class="var">Ï‰</span> &larr; <span class="val">10</span>', hidden: true },
                { id: 'r2', html: '<span class="kw">Î‘ÏÏ‡Î®_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚</span>', hidden: true },
                { id: 'r3', html: '    <span class="kw">Î“ÏÎ¬ÏˆÎµ</span> <span class="var">Ï‰</span>', hidden: true },
                { id: 'r4', html: '    <span class="var">Ï‰</span> &larr; <span class="var">Ï‰</span> + <span class="val">1</span>', hidden: true },
                { id: 'r5', html: '<span class="kw">Î¼Î­Ï‡ÏÎ¹Ï‚_ÏŒÏ„Î¿Ï…</span> <span class="var">Ï‰</span> > <span class="val">20</span>', hidden: true }
            ],
            steps: [
                { text: "1. Î‘ÏÏ‡Î¹ÎºÎ® Î¤Î¹Î¼Î®", action: "reveal", target: "r1" },
                { text: "2. ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î”Î¿Î¼Î®Ï‚", action: "fly", src: "w2", target: "r5", changeText: true }, // Oso -> Mechris
                { text: "3. Î‘ÏÏ‡Î® Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚", action: "fly", src: "w5", target: "r2", changeText: true }, // Telos -> Archi
                { text: "4. Î£ÏÎ¼Î± Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚", action: "revealGroup", targets: ["r3", "r4"] },
                { text: "ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·", action: "finish" }
            ]
        },
        // Scenario 2: General (IF)
        {
            src: [
                { id: 'w1b', html: '<span class="kw">Î”Î¹Î¬Î²Î±ÏƒÎµ</span> <span class="var">Ï‰</span>' },
                { id: 'w2b', html: '<span class="kw">ÎŒÏƒÎ¿</span> <span class="var">Ï‰</span> &le; <span class="val">20</span> <span class="kw">ÎµÏ€Î±Î½Î¬Î»Î±Î²Îµ</span>' },
                { id: 'w3b', html: '    <span class="kw">Î“ÏÎ¬ÏˆÎµ</span> <span class="var">Ï‰</span>' },
                { id: 'w4b', html: '    <span class="var">Ï‰</span> &larr; <span class="var">Ï‰</span> + <span class="val">1</span>' },
                { id: 'w5b', html: '<span class="kw">Î¤Î­Î»Î¿Ï‚_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚</span>' }
            ],
            tgt: [
                { id: 'r1b', html: '<span class="kw">Î”Î¹Î¬Î²Î±ÏƒÎµ</span> <span class="var">Ï‰</span>', hidden: true },
                { id: 'rIf', html: '<span class="kw">Î‘Î½</span> <span class="var">Ï‰</span> &le; <span class="val">20</span> <span class="kw">Ï„ÏŒÏ„Îµ</span>', hidden: true },
                { id: 'r2b', html: '    <span class="kw">Î‘ÏÏ‡Î®_ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚</span>', hidden: true },
                { id: 'r3b', html: '        <span class="kw">Î“ÏÎ¬ÏˆÎµ</span> <span class="var">Ï‰</span>', hidden: true },
                { id: 'r4b', html: '        <span class="var">Ï‰</span> &larr; <span class="var">Ï‰</span> + <span class="val">1</span>', hidden: true },
                { id: 'r5b', html: '    <span class="kw">Î¼Î­Ï‡ÏÎ¹Ï‚_ÏŒÏ„Î¿Ï…</span> <span class="var">Ï‰</span> > <span class="val">20</span>', hidden: true },
                { id: 'rEndIf', html: '<span class="kw">Î¤Î­Î»Î¿Ï‚_Î±Î½</span>', hidden: true }
            ],
            steps: [
                { text: "1. Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ Î¤Î¹Î¼Î®Ï‚", action: "reveal", target: "r1b" },
                { text: "2. ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ (Î‘Î½)", action: "reveal", target: "rIf" },
                { text: "3. ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î”Î¿Î¼Î®Ï‚", action: "fly", src: "w2b", target: "r5b", changeText: true },
                { text: "4. Î‘ÏÏ‡Î® Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚", action: "fly", src: "w5b", target: "r2b", changeText: true },
                { text: "5. Î£ÏÎ¼Î± Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·Ï‚", action: "revealGroup", targets: ["r3b", "r4b"] },
                { text: "6. ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿ (Î¤Î­Î»Î¿Ï‚_Î±Î½)", action: "reveal", target: "rEndIf" },
                { text: "ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·", action: "finish" }
            ]
        }
    ];

    // --- LOGIC ---
    let currentTab = 0;
    let stepIndex = 0;
    let isPlaying = false;
    let isAnimating = false;

    function loadTab(idx) {
        currentTab = idx;
        stepIndex = 0;
        isPlaying = false;
        isAnimating = false;
        
        // Update Buttons
        document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', i === idx));
        document.getElementById('info-content').innerHTML = TAB_INFO[idx];
        document.getElementById('btnPlay').innerText = "â–¶ Î‘Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®";
        document.getElementById('btnPlay').disabled = false;
        document.getElementById('btnStep').disabled = false;

        // Render Cards
        const scen = SCENARIOS[idx];
        const srcLines = scen.src.map(l => `<div class="line" id="${l.id}">${l.html}</div>`).join('');
        const tgtLines = scen.tgt.map(l => `<div class="line ${l.hidden?'hidden':''}" id="${l.id}">${l.html}</div>`).join('');

        document.getElementById('stage').innerHTML = `
            <div class="code-card">
                <div class="card-header">Î‘Î»Î³Î¿ÏÎ¹Î¸Î¼Î¿Ï‚ (ÎŸÎ£ÎŸ)</div>
                <div class="card-body">${srcLines}</div>
            </div>
            <div class="arrow-separator">&rarr;</div>
            <div class="code-card">
                <div class="card-header">Î™ÏƒÎ¿Î´Ï…Î½Î±Î¼Î¿ (ÎœÎ•Î§Î¡Î™Î£_ÎŸÎ¤ÎŸÎ¥)</div>
                <div class="card-body">${tgtLines}</div>
            </div>
        `;

        // Render Steps
        const ul = document.getElementById('steps-list');
        ul.innerHTML = '';
        scen.steps.forEach((s, i) => {
            const li = document.createElement('li');
            li.className = 'step-item';
            li.id = `step-${i}`;
            li.innerText = s.text;
            ul.appendChild(li);
        });
    }

    // --- ANIMATION FUNCTIONS ---
    
    function getSpeed() {
        const val = document.getElementById('speedRange').value;
        return 1500 - (val * 100); // 1->1400ms, 10->500ms
    }

    function flyElement(srcId, tgtId) {
        return new Promise(resolve => {
            const src = document.getElementById(srcId);
            const tgt = document.getElementById(tgtId);
            
            // Highlight Source
            src.classList.add('active');

            const flyer = document.createElement('div');
            flyer.className = 'flyer';
            flyer.innerHTML = src.innerHTML; // Copy content
            
            const r1 = src.getBoundingClientRect();
            const r2 = tgt.getBoundingClientRect();

            flyer.style.top = r1.top + 'px';
            flyer.style.left = r1.left + 'px';
            flyer.style.width = r1.width + 'px';
            document.body.appendChild(flyer);

            const duration = getSpeed();
            flyer.style.transitionDuration = duration + 'ms';

            requestAnimationFrame(() => {
                flyer.style.top = r2.top + 'px';
                flyer.style.left = r2.left + 'px';
                flyer.style.width = r2.width + 'px';
            });

            setTimeout(() => {
                flyer.remove();
                tgt.classList.remove('hidden');
                tgt.classList.add('visible');
                src.classList.remove('active');
                resolve();
            }, duration);
        });
    }

    function revealElement(id) {
        return new Promise(resolve => {
            const el = document.getElementById(id);
            el.classList.remove('hidden');
            el.classList.add('visible');
            setTimeout(resolve, getSpeed() / 2);
        });
    }

    async function executeStep() {
        const scen = SCENARIOS[currentTab];
        if (stepIndex >= scen.steps.length) {
            isPlaying = false;
            document.getElementById('btnPlay').disabled = true;
            document.getElementById('btnStep').disabled = true;
            return;
        }

        isAnimating = true;
        const step = scen.steps[stepIndex];

        // Update Steps List
        document.querySelectorAll('.step-item').forEach(li => li.classList.remove('active'));
        const activeLi = document.getElementById(`step-${stepIndex}`);
        if(activeLi) activeLi.classList.add('active');
        if(stepIndex > 0) document.getElementById(`step-${stepIndex-1}`).classList.add('done');

        // Logic
        if (step.action === 'reveal') {
            await revealElement(step.target);
        } else if (step.action === 'fly') {
            await flyElement(step.src, step.target);
        } else if (step.action === 'revealGroup') {
            for (let t of step.targets) {
                document.getElementById(t).classList.remove('hidden');
                document.getElementById(t).classList.add('visible');
            }
            await new Promise(r => setTimeout(r, getSpeed()));
        }

        isAnimating = false;
        stepIndex++;

        if (isPlaying) {
            setTimeout(executeStep, 200);
        }
    }

    function togglePlay() {
        if (isAnimating && isPlaying) {
            isPlaying = false;
            document.getElementById('btnPlay').innerText = "â–¶ Î£Ï…Î½Î­Ï‡ÎµÎ¹Î±";
        } else if (!isAnimating) {
            isPlaying = true;
            document.getElementById('btnPlay').innerText = "â¸ Î Î±ÏÏƒÎ·";
            executeStep();
        } else {
            isPlaying = true;
            document.getElementById('btnPlay').innerText = "â¸ Î Î±ÏÏƒÎ·";
        }
    }

    function manualStep() {
        if (isAnimating) return;
        executeStep();
    }

    function reset() {
        loadTab(currentTab);
    }

    // Initialize
    loadTab(0);

</script>
</body>
</html>