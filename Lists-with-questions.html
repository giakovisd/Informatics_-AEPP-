<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Î”Ï…Î½Î±Î¼Î¹ÎºÎ­Ï‚ Î”Î¿Î¼Î­Ï‚ Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ â€“ Î˜ÎµÏ‰ÏÎ¯Î± & Î•Ï†Î±ÏÎ¼Î¿Î³Î®</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #222;
      min-height: 100vh;
    }

    /* Enhanced header with gradient and shadow */
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 32px 24px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: headerPulse 8s ease-in-out infinite;
    }

    @keyframes headerPulse {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(-10%, -10%); }
    }

    header h1 {
      margin: 0;
      font-size: 28px;
      position: relative;
      z-index: 1;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    main {
      padding: 24px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Enhanced tabs with modern design */
    .tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      flex-wrap: wrap;
      background: rgba(255,255,255,0.95);
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
    }

    .tab-button {
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      color: #1565c0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      position: relative;
      overflow: hidden;
    }

    .tab-button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .tab-button:hover::before {
      width: 300px;
      height: 300px;
    }

    .tab-button.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .tab-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    /* Enhanced panel design */
    .panel {
      display: none;
      background: rgba(255,255,255,0.98);
      border-radius: 20px;
      padding: 32px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      margin-bottom: 24px;
      backdrop-filter: blur(10px);
      animation: panelFadeIn 0.5s ease-out;
    }

    @keyframes panelFadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .panel.active {
      display: block;
    }

    .panel h2 {
      margin-top: 0;
      font-size: 26px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .panel h3 {
        margin-top: 32px;
        margin-bottom: 16px;
        color: #667eea;
        border-bottom: 3px solid #e3f2fd;
        padding-bottom: 8px;
        font-size: 20px;
        font-weight: 700;
    }

    .panel h4 {
        margin-top: 20px;
        margin-bottom: 8px;
        color: #764ba2;
        font-size: 16px;
        font-weight: 600;
    }

    .panel small {
      color: #666;
      font-size: 14px;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 20px;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    /* Enhanced theory section styling */
    .theory-container {
        font-size: 16px;
        line-height: 1.8;
        color: #333;
    }
    .theory-container p {
        margin-bottom: 16px;
    }
    .theory-container ul {
        margin-bottom: 20px;
        padding-left: 20px;
        background: linear-gradient(135deg, #f8f9ff 0%, #e3f2fd 100%);
        padding: 20px 20px 20px 40px;
        border-radius: 12px;
        border-left: 5px solid #667eea;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    .theory-container li {
        margin-bottom: 10px;
    }
    .theory-diagram {
        display: flex;
        justify-content: center;
        margin: 32px 0;
        background: #ffffff;
        padding: 28px;
        border: 2px solid #e0e0e0;
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        overflow-x: auto;
    }
    .example-box {
        background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
        border: 2px solid #ffb300;
        padding: 20px;
        border-radius: 16px;
        margin-bottom: 24px;
        box-shadow: 0 6px 20px rgba(255, 179, 0, 0.15);
    }
    .example-title {
        font-weight: 700;
        font-size: 18px;
        color: #e65100;
        margin-bottom: 10px;
        display: block;
    }
    .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 15px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        border-radius: 12px;
        overflow: hidden;
    }
    .comparison-table th, .comparison-table td {
        border: 1px solid #e0e0e0;
        padding: 16px;
        text-align: left;
    }
    .comparison-table th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 700;
        font-size: 16px;
    }
    .comparison-table tr:nth-child(even) {
        background-color: #f8f9ff;
    }
    .comparison-table tr:hover {
        background-color: #e3f2fd;
        transition: background-color 0.3s ease;
    }

    /* Enhanced memory and structure sections */
    .memory-section,
    .control-section {
      background: linear-gradient(135deg, #fafbfd 0%, #f0f4ff 100%);
      border-radius: 16px;
      padding: 20px;
      border: 2px solid #e0e5f2;
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }

    .structure-visual {
      background: linear-gradient(135deg, #fafbfd 0%, #f0f4ff 100%);
      border-radius: 16px;
      padding: 20px;
      border: 2px solid #e0e5f2;
      margin-bottom: 20px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }

    .section-title {
      font-size: 17px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #37474f;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .memory-grid {
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 8px;
      margin-top: 12px;
    }

    /* Enhanced memory cells */
    .mem-cell {
      border-radius: 10px;
      padding: 8px;
      border: 2px dashed #cfd8dc;
      background: #ffffff;
      font-size: 11px;
      line-height: 1.4;
      min-height: 70px;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }

    .mem-cell.used {
      border-style: solid;
      border-color: #667eea;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
      transform: scale(1.02);
    }

    .mem-addr {
      font-weight: 700;
      color: #455a64;
      font-size: 12px;
    }

    .mem-content {
      margin-top: 4px;
      font-size: 12px;
      font-weight: 600;
      color: #1976d2;
    }

    .mem-ptrs {
      margin-top: 4px;
      font-size: 10px;
      color: #455a64;
    }

    .pointers {
      font-size: 14px;
      margin-bottom: 12px;
      color: #37474f;
      font-weight: 600;
    }

    .pointers span {
      font-weight: 700;
      color: #667eea;
      background: rgba(102, 126, 234, 0.1);
      padding: 4px 8px;
      border-radius: 6px;
    }

    /* Enhanced list visualization */
    .list-visual {
      display: flex;
      align-items: center;
      flex-wrap: nowrap;
      gap: 16px;
      min-height: 100px;
      padding: 16px 12px;
      border-radius: 12px;
      background: #ffffff;
      border: 2px solid #e0e5f2;
      overflow-x: auto;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
    }

    /* Enhanced node styling with better animations */
    .node {
      min-width: 140px;
      padding: 10px 12px;
      border-radius: 16px;
      background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
      border: 3px solid #ffb300;
      text-align: center;
      cursor: pointer;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(255, 179, 0, 0.2);
    }

    .node-doubly {
      min-width: 130px; 
    }

    .node:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(255, 179, 0, 0.3);
    }

    .node.selected {
      border-color: #ff6f00;
      box-shadow: 0 0 0 4px rgba(255, 111, 0, 0.3), 0 8px 24px rgba(255, 111, 0, 0.4);
      background: linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%);
      transform: scale(1.05);
    }

    .node-content {
      display: flex;
      align-items: stretch;
      justify-content: center;
      font-size: 14px;
      border-radius: 10px;
      overflow: hidden;
    }

    .node-singly .node-part,
    .node-doubly .node-part {
      flex: 1;
    }

    .node-part {
      padding: 8px 10px;
      box-sizing: border-box;
    }

    .node-part + .node-part {
      border-left: 2px solid #ffb300;
    }

    .value-part {
      font-weight: 800;
      font-size: 18px;
      color: #e65100;
    }

    .pointer-part {
      font-size: 11px;
      color: #455a64;
      white-space: nowrap;
      font-weight: 600;
    }
    /* Added styling for two-line pointer display in doubly linked list */
    .pointer-label {
      font-size: 9px;
      font-weight: 600;
      color: #455a64;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .pointer-addr {
      font-size: 11px;
      font-weight: 700;
      color: #e65100;
      margin-top: 2px;
    }

    .addr-label {
      margin-top: 4px;
      font-size: 11px;
      color: #546e7a;
      font-weight: 600;
    }

    .arrow {
      font-size: 24px;
      color: #667eea;
      font-weight: 700;
    }

    .double-arrow {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 18px;
      color: #667eea;
      gap: 2px;
      font-weight: 700;
    }

    /* Enhanced controls */
    .controls {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      font-size: 14px;
      font-weight: 600;
    }

    .controls input[type="number"],
    .controls select {
      padding: 8px 12px;
      border-radius: 10px;
      border: 2px solid #e0e5f2;
      font-size: 14px;
      min-width: 80px;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .controls input[type="number"]:focus,
    .controls select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    /* Enhanced buttons */
    .btn {
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      white-space: nowrap;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .btn.secondary {
      background: linear-gradient(135deg, #90a4ae 0%, #607d8b 100%);
      box-shadow: 0 4px 12px rgba(144, 164, 174, 0.3);
    }

    .btn.small {
      padding: 8px 14px;
      font-size: 13px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn.secondary:hover {
      box-shadow: 0 6px 20px rgba(144, 164, 174, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, #e53935 0%, #c62828 100%);
      box-shadow: 0 4px 12px rgba(229, 57, 53, 0.3);
    }
    .btn-danger:hover {
      box-shadow: 0 6px 20px rgba(229, 57, 53, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%);
      box-shadow: 0 4px 12px rgba(67, 160, 71, 0.3);
    }
    .btn-success:hover {
      box-shadow: 0 6px 20px rgba(67, 160, 71, 0.4);
    }

    /* Enhanced log section */
    .log {
      margin-top: 12px;
      padding: 16px;
      border-radius: 12px;
      background: linear-gradient(135deg, #f1f8e9 0%, #dcedc8 100%);
      border: 2px solid #aed581;
      font-size: 13px;
      max-height: 240px;
      overflow-y: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      line-height: 1.6;
    }

    .log strong {
      color: #33691e;
      font-weight: 700;
    }

    .log ol {
      margin: 8px 0 0 20px;
      padding: 0;
    }

    .hint {
      font-size: 12px;
      color: #78909c;
      margin-top: 8px;
      font-style: italic;
    }

    .head-box, .tail-box {
      padding: 8px 12px;
      border-radius: 10px;
      background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
      border: 2px solid #0288d1;
      font-size: 12px;
      text-align: center;
      min-width: 90px;
      box-shadow: 0 2px 8px rgba(2, 136, 209, 0.2);
      font-weight: 700;
    }

    .marker-title {
      font-weight: 700;
      font-size: 12px;
    }

    .marker-addr {
      font-size: 11px;
      color: #01579b;
      font-weight: 600;
    }

    /* Quiz Styles */
    .quiz-item {
        margin-bottom: 16px;
        padding: 16px;
        background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
        border-radius: 12px;
        border: 2px solid #e0e5f2;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
    }
    .quiz-item:hover {
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        transform: translateX(4px);
    }
    .quiz-question {
        font-weight: 700;
        margin-bottom: 10px;
        font-size: 15px;
        color: #37474f;
    }
    .quiz-options label {
        margin-right: 20px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: color 0.3s ease;
    }
    .quiz-options label:hover {
        color: #667eea;
    }
    .quiz-feedback {
        margin-top: 8px;
        font-weight: 700;
        font-size: 14px;
        padding: 8px;
        border-radius: 8px;
    }
    .correct-text { 
        color: #2e7d32; 
        background: rgba(46, 125, 50, 0.1);
    }
    .wrong-text { 
        color: #c62828;
        background: rgba(198, 40, 40, 0.1);
    }

    /* Slower, smoother animations - at least 3 seconds as requested */
    @keyframes slowInsert {
      0%   { 
        background: linear-gradient(135deg, #ffcdd2 0%, #ef9a9a 100%); 
        transform: translateY(-30px) scale(0.8); 
        opacity: 0;
      }
      30% {
        opacity: 1;
      }
      100% { 
        background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); 
        transform: translateY(0) scale(1); 
        opacity: 1;
      }
    }
    .flash-insert { animation: slowInsert 4s cubic-bezier(0.4, 0, 0.2, 1); }

    @keyframes slowPointer {
      0%   { background: #ffcdd2; color: #b71c1c; font-size: 140%; opacity: 1; }
      15%  { opacity: 0.3; }
      30%  { opacity: 1; }
      45%  { opacity: 0.3; }
      60%  { opacity: 1; }
      75%  { opacity: 0.3; }
      90%  { opacity: 1; }
      100% { background: inherit; color: inherit; font-size: 100%; opacity: 1; }
    }
    .flash-pointer { animation: slowPointer 4s ease-in-out; }

    @keyframes deleteMem {
      0%   { background: linear-gradient(135deg, #ffcdd2 0%, #ef9a9a 100%); transform: scale(1.1); }
      20%  { background: linear-gradient(135deg, #ffe082 0%, #ffd54f 100%); }
      40%  { background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%); }
      60%  { background: linear-gradient(135deg, #fffde7 0%, #fff9c4 100%); }
      80%  { background: #ffffff; transform: scale(0.95); }
      100% { background: #ffffff; transform: scale(1); }
    }
    .flash-delete-mem { animation: deleteMem 5s ease-in-out; }

    /* Slower, more dramatic delete animations - at least 3 seconds */
    .node.delete-mark {
      position: relative;
      opacity: 0;
      transform: scale(0.7) rotate(5deg);
      transition: all 3.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .node.delete-mark::before {
      content: "âœ•";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 90px;
      color: rgba(211, 47, 47, 0.7);
      font-weight: bold;
      pointer-events: none;
      z-index: 10;
      display: block;
      animation: deleteMarkAppear 3.5s ease-out;
    }

    @keyframes deleteMarkAppear {
      0% { 
        font-size: 0px; 
        opacity: 0; 
        transform: translate(-50%, -50%) rotate(-180deg);
      }
      50% { 
        font-size: 100px; 
        opacity: 1;
        transform: translate(-50%, -50%) rotate(0deg);
      }
      100% { 
        font-size: 90px; 
        opacity: 0.7;
        transform: translate(-50%, -50%) rotate(5deg);
      }
    }

    .node.node-collapse {
      max-width: 0 !important;
      min-width: 0 !important;
      padding: 0 !important;
      margin: 0 !important;
      border: 0 !important;
      overflow: hidden;
      opacity: 0;
      transform: scaleX(0);
      transition: all 3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Smooth scrollbar styling */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }
  </style>
</head>
<body>
<header>
  <h1>ğŸ“ Î”Ï…Î½Î±Î¼Î¹ÎºÎ­Ï‚ Î”Î¿Î¼Î­Ï‚ Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ â€“ Î˜ÎµÏ‰ÏÎ¯Î± & Î•Ï†Î±ÏÎ¼Î¿Î³Î®</h1>
</header>

<main>
  <div class="tabs">
    <button class="tab-button active" data-target="panel-theory">ğŸ“š Î˜ÎµÏ‰ÏÎ¯Î± Î›Î¹ÏƒÏ„ÏÎ½</button>
    <button class="tab-button" data-target="panel-singly">ğŸ”— Î‘Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±</button>
    <button class="tab-button" data-target="panel-doubly">â‡„ Î”Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±</button>
    <button class="tab-button" data-target="panel-stack">ğŸ“š Î£Ï„Î¿Î¯Î²Î± Î¼Îµ Î»Î¯ÏƒÏ„Î±</button>
    <button class="tab-button" data-target="panel-queue">ğŸ« ÎŸÏ…ÏÎ¬ Î¼Îµ Î»Î¯ÏƒÏ„Î±</button>
    <button class="tab-button" data-target="panel-quiz">âœ… Î‘Ï…Ï„Î¿Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ·</button>
  </div>


  <section class="panel active" id="panel-theory">
    <h2>Î˜ÎµÏ‰ÏÎ¯Î±: Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½ÎµÏ‚ Î›Î¯ÏƒÏ„ÎµÏ‚</h2>
    <div class="theory-container">
      
      <div class="example-box">
        <span class="example-title">ğŸ’¡ Î— Î›Î¯ÏƒÏ„Î± ÏƒÏ„Î·Î½ ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î® Î¶Ï‰Î®</span>
        <p>Î— Î­Î½Î½Î¿Î¹Î± Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ ÏƒÏ…Î½Î±Î½Ï„Î¬Ï„Î±Î¹ Ï€Î¿Î»Ï ÏƒÏ…Ï‡Î½Î¬ ÏƒÏ„Î·Î½ ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½ÏŒÏ„Î·Ï„Î¬ Î¼Î±Ï‚. Î£ÎºÎµÏ†Ï„ÎµÎ¯Ï„Îµ Ï€ÏŒÏƒÎµÏ‚ Ï†Î¿ÏÎ­Ï‚ Î­Ï‡ÎµÏ„Îµ Ï†Ï„Î¹Î¬Î¾ÎµÎ¹:</p>
        <ul>
            <li>ÎœÎ¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï„Î± Î±Î³Î±Ï€Î·Î¼Î­Î½Î± ÏƒÎ±Ï‚ <strong>Ï„ÏÎ±Î³Î¿ÏÎ´Î¹Î±</strong> ÏƒÏ„Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ.</li>
            <li>ÎœÎ¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï„Î¹Ï‚ <strong>ÎµÏ€Î±Ï†Î­Ï‚</strong> ÏƒÎ±Ï‚.</li>
            <li>ÎœÎ¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï„Î± <strong>ÏˆÏÎ½Î¹Î±</strong> Ï„Î¿Ï… ÏƒÎ¿ÏÏ€ÎµÏ Î¼Î¬ÏÎºÎµÏ„.</li>
            <li>ÎœÎ¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ <strong>ÎµÏ€Î¹Î¸Ï…Î¼Î¯ÎµÏ‚ ÎºÎ±Î¹ ÏŒÎ½ÎµÎ¹ÏÎ±</strong> (bucket list).</li>
        </ul>
        <p>Î— Î»Î¯ÏƒÏ„Î± ÏƒÏ„Î·Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÎºÎ® Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Î¯Ï€Î¿Ï„Î± Î¬Î»Î»Î¿ Ï€Î±ÏÎ¬ Î¼Î¹Î± ÏƒÏ…Î»Î»Î¿Î³Î® Î±Ï€ÏŒ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± (Î´ÎµÎ´Î¿Î¼Î­Î½Î±) Ï„Î¿Ï… Î¯Î´Î¹Î¿Ï… Ï„ÏÏ€Î¿Ï…, Î¿ÏÎ³Î±Î½Ï‰Î¼Î­Î½Î± ÏƒÎµ Î¼Î¹Î± ÏƒÎµÎ¹ÏÎ¬.</p>
      </div>

      <h3>1. Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Î· Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î›Î¯ÏƒÏ„Î±;</h3>
      <p>
        Î— ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± <strong>Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î´Î¿Î¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½</strong>. Î£Îµ Î±Î½Ï„Î¯Î¸ÎµÏƒÎ· Î¼Îµ Ï„Î¿Ï…Ï‚ Ï€Î¯Î½Î±ÎºÎµÏ‚, ÏŒÏ€Î¿Ï… Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÎµ ÏƒÏ…Î½ÎµÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Î¼Î½Î®Î¼Î·Ï‚ (ÏƒÎ±Î½ ÏƒÏ€Î¯Ï„Î¹Î± ÏƒÎµ Î­Î½Î±Î½ Î´ÏÏŒÎ¼Î¿), ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± (Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ <strong>ÎºÏŒÎ¼Î²Î¿Î¹</strong>) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±ÏƒÎºÎ¿ÏÏ€Î¹ÏƒÎ¼Î­Î½Î± Î¿Ï€Î¿Ï…Î´Î®Ï€Î¿Ï„Îµ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.
      </p>
      
      <p>ÎšÎ¬Î¸Îµ <strong>ÎºÏŒÎ¼Î²Î¿Ï‚</strong> Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Î´ÏÎ¿ Î¼Î­ÏÎ·:</p>
      <ul>
        <li><strong>Î”ÎµÎ´Î¿Î¼Î­Î½Î±:</strong> Î— Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Ï€Î¿Ï… Î¸Î­Î»Î¿Ï…Î¼Îµ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎ¿Ï…Î¼Îµ (Ï€.Ï‡. Î±ÏÎ¹Î¸Î¼ÏŒÏ‚, ÏŒÎ½Î¿Î¼Î±).</li>
        <li><strong>Î”ÎµÎ¯ÎºÏ„Î·Ï‚ (Pointer):</strong> Î— Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… <em>ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï…</em> ÎºÏŒÎ¼Î²Î¿Ï… ÏƒÏ„Î· ÏƒÎµÎ¹ÏÎ¬. ÎˆÏ„ÏƒÎ¹ Î¾Î­ÏÎ¿Ï…Î¼Îµ Ï€Î¿Ï Î½Î± Ï€Î¬Î¼Îµ Î¼ÎµÏ„Î¬.</li>
      </ul>

      <div class="theory-diagram">
        <svg width="240" height="100" viewBox="0 0 240 100">
            <rect x="20" y="20" width="160" height="60" rx="5" ry="5" fill="#fff9c4" stroke="#fbc02d" stroke-width="2"/>
            <line x1="100" y1="20" x2="100" y2="80" stroke="#fbc02d" stroke-width="2"/>
            <text x="60" y="55" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#333">Î”ÎµÎ´Î¿Î¼Î­Î½Î±</text>
            <text x="140" y="45" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold" fill="#333">Î”ÎµÎ¯ÎºÏ„Î·Ï‚</text>
            <text x="140" y="65" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">(Ï€ÏÎ¿Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿)</text>
            <line x1="180" y1="50" x2="220" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
            <defs>
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                  <path d="M0,0 L0,6 L9,3 z" fill="#333" />
                </marker>
            </defs>
            <text x="100" y="95" text-anchor="middle" font-family="Arial" font-size="12" fill="#555">Î”Î¿Î¼Î® ÎµÎ½ÏŒÏ‚ ÎšÏŒÎ¼Î²Î¿Ï…</text>
        </svg>
      </div>

      <p>
        Î— Î»Î¯ÏƒÏ„Î± ÏƒÏ…Î½Î¿Î´ÎµÏÎµÏ„Î±Î¹ Ï€Î¬Î½Ï„Î± Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÎ¹Î´Î¹ÎºÏŒ Î´ÎµÎ¯ÎºÏ„Î·, Ï„Î·Î½ <strong>ÎšÎµÏ†Î±Î»Î® (Head)</strong>, Ï€Î¿Ï… Î¼Î±Ï‚ Î»Î­ÎµÎ¹ Ï€Î¿Ï Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¿ Ï€ÏÏÏ„Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚. 
        ÎŸ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î¿ <strong>NULL</strong> (ÎºÎµÎ½ÏŒ), Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ "Ï„Î­Î»Î¿Ï‚ Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚".
      </p>

      <h3>2. ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Î›Î¹ÏƒÏ„ÏÎ½</h3>
      
      <h4>Î‘. Î‘Ï€Î»Î¬ Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î›Î¯ÏƒÏ„Î±</h4>
      <p>Î•Î¯Î½Î±Î¹ Î· Ï€Î¹Î¿ Î±Ï€Î»Î® Î¼Î¿ÏÏ†Î®. ÎšÎ¬Î¸Îµ ÎºÏŒÎ¼Î²Î¿Ï‚ ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ Î¼Îµ Ï„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½ÏŒ Ï„Î¿Ï…. ÎœÏ€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï„Î· Î´Î¹Î±ÏƒÏ‡Î¯ÏƒÎ¿Ï…Î¼Îµ Î¼ÏŒÎ½Î¿ Ï€ÏÎ¿Ï‚ Î¼Î¯Î± ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· (Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î® Ï€ÏÎ¿Ï‚ Ï„Î¿ Ï„Î­Î»Î¿Ï‚), ÏŒÏ€Ï‰Ï‚ ÏƒÎµ Î­Î½Î±Î½ Î±Î³ÏÎ½Î± ÏƒÎºÏ…Ï„Î±Î»Î¿Î´ÏÎ¿Î¼Î¯Î±Ï‚.</p>

      <div class="theory-diagram">
        <svg width="620" height="100" viewBox="0 0 620 100">
            <rect x="10" y="35" width="50" height="30" fill="#e1f5fe" stroke="#0277bd"/>
            <text x="35" y="55" text-anchor="middle" font-weight="bold" font-size="12">HEAD</text>
            <line x1="60" y1="50" x2="80" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

            <g transform="translate(80, 20)">
                <rect x="0" y="0" width="40" height="60" fill="#c8e6c9" stroke="#2e7d32"/> <text x="20" y="35" text-anchor="middle" font-weight="bold">10</text>
                <rect x="40" y="0" width="20" height="60" fill="#a5d6a7" stroke="#2e7d32"/> <circle cx="50" cy="30" r="3" fill="#333"/>
            </g>
            <line x1="140" y1="50" x2="190" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

            <g transform="translate(190, 20)">
                <rect x="0" y="0" width="40" height="60" fill="#c8e6c9" stroke="#2e7d32"/>
                <text x="20" y="35" text-anchor="middle" font-weight="bold">20</text>
                <rect x="40" y="0" width="20" height="60" fill="#a5d6a7" stroke="#2e7d32"/>
                <circle cx="50" cy="30" r="3" fill="#333"/>
            </g>
            <line x1="250" y1="50" x2="300" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

            <g transform="translate(300, 20)">
                <rect x="0" y="0" width="40" height="60" fill="#c8e6c9" stroke="#2e7d32"/>
                <text x="20" y="35" text-anchor="middle" font-weight="bold">30</text>
                <rect x="40" y="0" width="20" height="60" fill="#a5d6a7" stroke="#2e7d32"/>
                <circle cx="50" cy="30" r="3" fill="#333"/>
            </g>
            <line x1="360" y1="50" x2="410" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

            <g transform="translate(410, 20)">
                <rect x="0" y="0" width="40" height="60" fill="#c8e6c9" stroke="#2e7d32"/>
                <text x="20" y="35" text-anchor="middle" font-weight="bold">40</text>
                <rect x="40" y="0" width="20" height="60" fill="#a5d6a7" stroke="#2e7d32"/>
                <circle cx="50" cy="30" r="3" fill="#333"/>
            </g>
            <line x1="470" y1="50" x2="520" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

            <g transform="translate(520, 35)">
                <rect x="0" y="0" width="50" height="30" rx="5" fill="#eeeeee" stroke="#999"/>
                <text x="25" y="20" text-anchor="middle" fill="#666" font-weight="bold" font-size="12">NULL</text>
            </g>
        </svg>
      </div>

      <h4>Î’. Î”Î¹Ï€Î»Î¬ Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î›Î¯ÏƒÏ„Î±</h4>
      <p>Î•Î´Ï, ÎºÎ¬Î¸Îµ ÎºÏŒÎ¼Î²Î¿Ï‚ Î­Ï‡ÎµÎ¹ <strong>Î´ÏÎ¿ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚</strong>: Î­Î½Î±Î½ Î³Î¹Î± Ï„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Î¹ Î­Î½Î±Î½ Î³Î¹Î± Ï„Î¿Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÏŒÎ¼Î²Î¿. Î‘Ï…Ï„ÏŒ Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¹Î½Î¿ÏÎ¼Î±ÏƒÏ„Îµ ÎºÎ±Î¹ Ï€ÏÎ¿Ï‚ Ï„Î¹Ï‚ Î´ÏÎ¿ ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚.</p>
      
      <div class="theory-diagram">
        <svg width="680" height="140" viewBox="0 0 680 140">
            <rect x="10" y="20" width="50" height="30" fill="#e1f5fe" stroke="#0277bd"/>
            <text x="35" y="40" text-anchor="middle" font-weight="bold" font-size="12">HEAD</text>
            <path d="M60 35 L 80 35 L 80 50" stroke="#0277bd" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

            <g transform="translate(80, 50)">
                <rect x="0" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/> <rect x="20" y="0" width="40" height="40" fill="#ffab91" stroke="#d84315"/> <text x="40" y="25" text-anchor="middle" font-weight="bold">100</text>
                <rect x="60" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/> <text x="10" y="25" text-anchor="middle" font-size="8">NULL</text>
            </g>

            <line x1="160" y1="60" x2="200" y2="60" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/> <line x1="200" y1="80" x2="160" y2="80" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/> <g transform="translate(200, 50)">
                <rect x="0" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
                <rect x="20" y="0" width="40" height="40" fill="#ffab91" stroke="#d84315"/>
                <text x="40" y="25" text-anchor="middle" font-weight="bold">200</text>
                <rect x="60" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
            </g>

            <line x1="280" y1="60" x2="320" y2="60" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
            <line x1="320" y1="80" x2="280" y2="80" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>

            <g transform="translate(320, 50)">
                <rect x="0" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
                <rect x="20" y="0" width="40" height="40" fill="#ffab91" stroke="#d84315"/>
                <text x="40" y="25" text-anchor="middle" font-weight="bold">300</text>
                <rect x="60" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
            </g>

            <line x1="400" y1="60" x2="440" y2="60" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
            <line x1="440" y1="80" x2="400" y2="80" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>

            <g transform="translate(440, 50)">
                <rect x="0" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
                <rect x="20" y="0" width="40" height="40" fill="#ffab91" stroke="#d84315"/>
                <text x="40" y="25" text-anchor="middle" font-weight="bold">400</text>
                <rect x="60" y="0" width="20" height="40" fill="#ffccbc" stroke="#d84315"/>
                <text x="70" y="25" text-anchor="middle" font-size="8">NULL</text>
            </g>

            <rect x="550" y="20" width="50" height="30" fill="#e1f5fe" stroke="#0277bd"/>
            <text x="575" y="40" text-anchor="middle" font-weight="bold" font-size="12">TAIL</text>
            <path d="M550 35 L 500 35 L 500 50" stroke="#0277bd" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

        </svg>
      </div>

      <h3>3. Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î ÏÎ¬Î¾ÎµÎ¹Ï‚ Î›Î¹ÏƒÏ„ÏÎ½</h3>
      <p>Î£Îµ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¹Ï‚ ÎµÎ¾Î®Ï‚ Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚:</p>
      <ol>
          <li><strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®:</strong> Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… (ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®, ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Î® ÎµÎ½Î´Î¹Î¬Î¼ÎµÏƒÎ±).</li>
          <li><strong>Î”Î¹Î±Î³ÏÎ±Ï†Î®:</strong> Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï….</li>
          <li><strong>ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎšÎµÎ½Î¿Ï:</strong> ÎÎ± Î´Î¿ÏÎ¼Îµ Î±Î½ Î· Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î± (Î±Î½ Î· ÎšÎµÏ†Î±Î»Î® ÎµÎ¯Î½Î±Î¹ NULL).</li>
          <li><strong>Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·:</strong> ÎÎ± ÏˆÎ¬Î¾Î¿Ï…Î¼Îµ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±.</li>
          <li><strong>Î”Î¹Î¬ÏƒÏ‡Î¹ÏƒÎ·:</strong> ÎÎ± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Î±Ï€ÏŒ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ (Ï€.Ï‡. Î³Î¹Î± Î½Î± Ï„Î¿Ï…Ï‚ Ï„Ï…Ï€ÏÏƒÎ¿Ï…Î¼Îµ).</li>
      </ol>

      <h3>4. Î ÏÏ‚ Î³Î¯Î½ÎµÏ„Î±Î¹ Î· Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÎ±Î¹ Î· Î”Î¹Î±Î³ÏÎ±Ï†Î®;</h3>
      
      <h4>Î— Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï„Î·Ï‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚</h4>
      <p>
        Î‘Ï‚ Ï…Ï€Î¿Î¸Î­ÏƒÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ ÏƒÏ‡ÎµÎ´Î¹Î¬Î¶Î¿Ï…Î¼Îµ Î­Î½Î± Ï„Î±Î¾Î¯Î´Î¹: <strong>Î‘Î¸Î®Î½Î± &rarr; Î›Î±Î¼Î¯Î± &rarr; Î›Î¬ÏÎ¹ÏƒÎ±</strong>.
        ÎÎ±Ï†Î½Î¹ÎºÎ¬, Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶Î¿Ï…Î¼Îµ Î½Î± ÎµÏ€Î¹ÏƒÎºÎµÏ†Î¸Î¿ÏÎ¼Îµ Ï„Î¿Î½ <strong>Î’ÏŒÎ»Î¿</strong> Î¼ÎµÏ„Î¬ Ï„Î· Î›Î±Î¼Î¯Î± ÎºÎ±Î¹ Ï€ÏÎ¹Î½ Ï„Î· Î›Î¬ÏÎ¹ÏƒÎ±.
        Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±, Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¯Ï€Î¿Ï„Î±. Î‘Ï€Î»ÏÏ‚ Î±Î»Î»Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿Ï…Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚:
      </p>
      <ul>
          <li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Ï„Î·Ï‚ <strong>Î›Î±Î¼Î¯Î±Ï‚</strong> (Ï€Î¿Ï… Î­Î´ÎµÎ¹Ï‡Î½Îµ Î›Î¬ÏÎ¹ÏƒÎ±) Ï„ÏÏÎ± Î¸Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î¿Î½ <strong>Î’ÏŒÎ»Î¿</strong>.</li>
          <li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Ï„Î¿Ï… <strong>Î’ÏŒÎ»Î¿Ï…</strong> Î¸Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î· <strong>Î›Î¬ÏÎ¹ÏƒÎ±</strong>.</li>
      </ul>

      <div class="theory-diagram">
        <svg width="400" height="120" viewBox="0 0 400 120">
            <rect x="10" y="40" width="70" height="30" fill="#c8e6c9" stroke="green"/>
            <text x="45" y="60" text-anchor="middle" font-size="12">Î›Î±Î¼Î¯Î±</text>
            
            <rect x="300" y="40" width="70" height="30" fill="#c8e6c9" stroke="green"/>
            <text x="335" y="60" text-anchor="middle" font-size="12">Î›Î¬ÏÎ¹ÏƒÎ±</text>
            
            <rect x="150" y="80" width="70" height="30" fill="#ffecb3" stroke="orange"/>
            <text x="185" y="100" text-anchor="middle" font-size="12">Î’ÏŒÎ»Î¿Ï‚</text>
            
            <line x1="80" y1="55" x2="300" y2="55" stroke="red" stroke-width="1" stroke-dasharray="4"/>
            <line x1="180" y1="45" x2="200" y2="65" stroke="red" stroke-width="2">
                <title>Î”Î¹Î±ÎºÎ¿Ï€Î® Ï€Î±Î»Î¹Î¬Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚</title>
            </line>
            <line x1="200" y1="45" x2="180" y2="65" stroke="red" stroke-width="2"/>

            <path d="M80 55 Q 115 55, 150 95" stroke="green" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
            <path d="M220 95 Q 260 55, 300 55" stroke="green" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
        </svg>
      </div>

      <h4>Î— Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï„Î·Ï‚ Î”Î¹Î±Î³ÏÎ±Ï†Î®Ï‚</h4>
      <p>
        Î‘Î½ Ï„ÎµÎ»Î¹ÎºÎ¬ Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÎ¿Ï…Î¼Îµ Î½Î± <strong>Î¼Î·Î½</strong> Ï€Î¬Î¼Îµ ÏƒÏ„Î· Î›Î±Î¼Î¯Î± (Î‘Î¸Î®Î½Î± &rarr; Î›Î±Î¼Î¯Î± &rarr; Î›Î¬ÏÎ¹ÏƒÎ±), Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î· Î´Î¹Î±Î³ÏÎ¬ÏˆÎ¿Ï…Î¼Îµ.
        Î¤ÏŒÏ„Îµ, Î±Î»Î»Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î· Ï„Î·Ï‚ <strong>Î‘Î¸Î®Î½Î±Ï‚</strong> (Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚) ÏÏƒÏ„Îµ Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÎºÎ±Ï„ÎµÏ…Î¸ÎµÎ¯Î±Î½ ÏƒÏ„Î· <strong>Î›Î¬ÏÎ¹ÏƒÎ±</strong>, Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î· Î›Î±Î¼Î¯Î±.
        Î— Î›Î±Î¼Î¯Î± Î±Ï€Î¿ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î· Î»Î¯ÏƒÏ„Î±.
      </p>

      <div class="theory-diagram">
        <svg width="400" height="120" viewBox="0 0 400 120">
            <rect x="10" y="40" width="70" height="30" fill="#e1f5fe" stroke="#0277bd"/>
            <text x="45" y="60" text-anchor="middle" font-size="12">Î‘Î¸Î®Î½Î±</text>
            
            <rect x="150" y="40" width="70" height="30" fill="#ffcdd2" stroke="#c62828" stroke-dasharray="2"/>
            <text x="185" y="60" text-anchor="middle" font-size="12" fill="#c62828">Î›Î±Î¼Î¯Î±</text>
            <line x1="150" y1="40" x2="220" y2="70" stroke="#c62828" stroke-width="2"/>
            <line x1="220" y1="40" x2="150" y2="70" stroke="#c62828" stroke-width="2"/>
            
            <rect x="300" y="40" width="70" height="30" fill="#e1f5fe" stroke="#0277bd"/>
            <text x="335" y="60" text-anchor="middle" font-size="12">Î›Î¬ÏÎ¹ÏƒÎ±</text>
            
            <path d="M80 55 Q 190 10, 300 55" stroke="green" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
            <text x="190" y="25" text-anchor="middle" font-size="11" fill="green" font-style="italic">ÎÎ­Î± ÏƒÏÎ½Î´ÎµÏƒÎ·</text>

            <line x1="80" y1="55" x2="150" y2="55" stroke="#ccc" stroke-width="1" stroke-dasharray="4"/>
            <line x1="220" y1="55" x2="300" y2="55" stroke="#ccc" stroke-width="1" stroke-dasharray="4"/>
        </svg>
      </div>

      <h3>5. Î£ÏÎ³ÎºÏÎ¹ÏƒÎ·: Î Î¯Î½Î±ÎºÎµÏ‚ vs Î›Î¯ÏƒÏ„ÎµÏ‚</h3>
      <table class="comparison-table">
        <thead>
          <tr>
            <th>Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ</th>
            <th>Î Î¯Î½Î±ÎºÎ±Ï‚ (Î£Ï„Î±Ï„Î¹ÎºÎ® Î”Î¿Î¼Î®)</th>
            <th>Î›Î¯ÏƒÏ„Î± (Î”Ï…Î½Î±Î¼Î¹ÎºÎ® Î”Î¿Î¼Î®)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>ÎœÎ½Î®Î¼Î·</strong></td>
            <td>Î£Ï…Î½ÎµÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ (ÏƒÎ±Î½ ÏƒÏ€Î¯Ï„Î¹Î± ÏƒÏ„Î· ÏƒÎµÎ¹ÏÎ¬)</td>
            <td>ÎœÎ· ÏƒÏ…Î½ÎµÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ (Î´Î¹Î¬ÏƒÏ€Î±ÏÏ„ÎµÏ‚)</td>
          </tr>
          <tr>
            <td><strong>ÎœÎ­Î³ÎµÎ¸Î¿Ï‚</strong></td>
            <td>Î£Ï„Î±Î¸ÎµÏÏŒ (Ï„Î¿ Î´Î·Î»ÏÎ½Î¿Ï…Î¼Îµ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®)</td>
            <td>ÎœÎµÏ„Î±Î²Î»Î·Ï„ÏŒ (Î±Ï…Î¾Î¿Î¼ÎµÎ¹ÏÎ½ÎµÏ„Î±Î¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬)</td>
          </tr>
          <tr>
            <td><strong>Î ÏÎ¿ÏƒÏ€Î­Î»Î±ÏƒÎ·</strong></td>
            <td>Î¤Ï…Ï‡Î±Î¯Î± / Î†Î¼ÎµÏƒÎ· (Î¼Ï€Î¿ÏÏ Î½Î± Ï€Î¬Ï‰ ÎºÎ±Ï„ÎµÏ…Î¸ÎµÎ¯Î±Î½ ÏƒÏ„Î¿ 5Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿)</td>
            <td>Î£ÎµÎ¹ÏÎ¹Î±ÎºÎ® (Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÎµÏÎ¬ÏƒÏ‰ Î±Ï€ÏŒ ÏŒÎ»Î± Ï„Î± Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î±)</td>
          </tr>
        </tbody>
      </table>

      <h3>6. Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± & ÎœÎµÎ¹Î¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±</h3>
      <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
        <div style="flex: 1; min-width: 300px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 16px; border: 2px solid #81c784; box-shadow: 0 4px 16px rgba(0,0,0,0.1);">
          <strong style="color: #2e7d32; font-size: 18px; display:block; margin-bottom:12px;">âœ… Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± Î›Î¹ÏƒÏ„ÏÎ½</strong>
          <ul style="margin: 0; padding-left: 20px; color: #1b5e20;">
            <li><strong>Î”Ï…Î½Î±Î¼Î¹ÎºÏŒ Î¼Î­Î³ÎµÎ¸Î¿Ï‚:</strong> Î”ÎµÎ½ Î´ÎµÏƒÎ¼ÎµÏÎ¿Ï…Î¼Îµ Ï€ÎµÏÎ¹Ï„Ï„Î® Î¼Î½Î®Î¼Î· ÎºÎ±Î¹ Î´ÎµÎ½ Î¼Î±Ï‚ "Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹" Î¿ Ï‡ÏÏÎ¿Ï‚.</li>
            <li><strong>Î•ÏÎºÎ¿Î»Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®/Î´Î¹Î±Î³ÏÎ±Ï†Î®:</strong> Î‘Î»Î»Î¬Î¶Î¿Ï…Î¼Îµ Î±Ï€Î»ÏÏ‚ Ï„Î¿Ï…Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚, Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± Î¬Î»Î»Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± (ÏŒÏ€Ï‰Ï‚ Î¸Î± ÎºÎ¬Î½Î±Î¼Îµ ÏƒÎµ Î­Î½Î±Î½ Ï€Î¯Î½Î±ÎºÎ±).</li>
          </ul>
        </div>
        <div style="flex: 1; min-width: 300px; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); padding: 20px; border-radius: 16px; border: 2px solid #e57373; box-shadow: 0 4px 16px rgba(0,0,0,0.1);">
          <strong style="color: #c62828; font-size: 18px; display:block; margin-bottom:12px;">âš ï¸ ÎœÎµÎ¹Î¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± Î›Î¹ÏƒÏ„ÏÎ½</strong>
          <ul style="margin: 0; padding-left: 20px; color: #b71c1c;">
            <li><strong>Î‘ÏÎ³Î® Ï€ÏÎ¿ÏƒÏ€Î­Î»Î±ÏƒÎ·:</strong> Î”ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï€Î¬Î¼Îµ ÎºÎ±Ï„ÎµÏ…Î¸ÎµÎ¯Î±Î½ ÏƒÏ„Î¿ 100Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿. Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Î±Ï€ÏŒ Ï„Î± 99 Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î±.</li>
            <li><strong>Î”ÎµÎ½ Î³Î¯Î½ÎµÏ„Î±Î¹ Î”Ï…Î±Î´Î¹ÎºÎ® Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·:</strong> Î›ÏŒÎ³Ï‰ Ï„Î·Ï‚ ÏƒÎµÎ¹ÏÎ¹Î±ÎºÎ®Ï‚ Ï€ÏÎ¿ÏƒÏ€Î­Î»Î±ÏƒÎ·Ï‚.</li>
            <li><strong>Î•Ï€Î¹Ï€Î»Î­Î¿Î½ ÎœÎ½Î®Î¼Î·:</strong> ÎšÎ¬Î¸Îµ ÎºÏŒÎ¼Î²Î¿Ï‚ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î­Î¾Ï„ÏÎ± Ï‡ÏÏÎ¿ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î·.</li>
          </ul>
        </div>
      </div>

    </div>
  </section>

  <section class="panel" id="panel-singly">
    <h2>Î‘Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± (Î¼Î­Ï‡ÏÎ¹ 10 ÎºÏŒÎ¼Î²Î¿Ï…Ï‚)</h2>
    <small>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® &amp; Î´Î¹Î±Î³ÏÎ±Ï†Î® ÎºÏŒÎ¼Î²Î¿Ï… Î¼Îµ Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ RAM.</small>

    <div class="structure-visual">
      <div class="section-title">Î“ÏÎ±Ï†Î¹ÎºÎ® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Î±Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚</div>
      <div class="pointers">
        Head: <span id="singly-head">NULL</span>
      </div>
      <div id="singly-visual" class="list-visual"></div>
      <div class="hint" id="singly-selected-label">ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: ÎºÎ±Î½Î­Î½Î±Ï‚</div>
    </div>

    <div class="layout">
      <div class="memory-section">
        <div class="section-title">ÎœÎ½Î®Î¼Î· RAM (Ï€Î»Î­Î³Î¼Î± 5x6)</div>
        <div id="singly-memory" class="memory-grid"></div>
        <div class="hint">Î¤Î± Î³Î±Î»Î¬Î¶Î¹Î± ÎºÎµÎ»Î¹Î¬ ÎµÎ¯Î½Î±Î¹ Î´ÎµÏƒÎ¼ÎµÏ…Î¼Î­Î½Î± Î±Ï€ÏŒ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚.</div>
      </div>

      <div class="control-section">
        <div class="section-title">Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Î»Î¯ÏƒÏ„Î±Ï‚</div>

        <div class="controls">
          Î Î»Î®Î¸Î¿Ï‚ ÎºÏŒÎ¼Î²Ï‰Î½:
          <input type="number" id="singly-count" value="5" min="1" max="10">
          <button class="btn small" id="singly-init">Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î»Î¯ÏƒÏ„Î±</button>
        </div>

        <div class="controls">
          Î¤Î¹Î¼Î®:
          <input type="number" id="singly-value" value="99">
          Î˜Î­ÏƒÎ·:
          <select id="singly-position">
            <option value="head">Î£Ï„Î·Î½ Î±ÏÏ‡Î® Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚</option>
            <option value="after">ÎœÎµÏ„Î¬ Ï„Î¿Î½ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ ÎºÏŒÎ¼Î²Î¿</option>
          </select>
          <button class="btn small" id="singly-insert">Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÏŒÎ¼Î²Î¿Ï…</button>
        </div>

        <div class="controls">
          <button class="btn small btn-danger" id="singly-delete">Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…</button>
          <button class="btn small btn-success" id="singly-clear">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚</button>
        </div>

        <div class="hint">ÎšÎ¬Î½Îµ ÎºÎ»Î¹Îº ÏƒÎµ Î­Î½Î±Î½ ÎºÏŒÎ¼Î²Î¿ Î³Î¹Î± Î½Î± Ï„Î¿Î½ ÎµÏ€Î¹Î»Î­Î¾ÎµÎ¹Ï‚. ÎŸ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î­Ï‡ÎµÎ¹ next = NULL.</div>

        <div id="singly-log" class="log">
          <strong>ÎŸÎ´Î·Î³Î¯ÎµÏ‚:</strong> Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï€ÏŒÏƒÎ¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Î¸Î­Î»ÎµÎ¹Ï‚ (1â€“10), Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Ï„Î· Î»Î¯ÏƒÏ„Î± ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ ÎºÎ¬Î½Îµ
          ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î­Ï‚ / Î´Î¹Î±Î³ÏÎ±Ï†Î­Ï‚ ÎµÏ€Î¹Î»Î­Î³Î¿Î½Ï„Î±Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚.
        </div>
      </div>
    </div>
  </section>

  <section class="panel" id="panel-doubly">
    <h2>Î”Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± (Î¼Î­Ï‡ÏÎ¹ 10 ÎºÏŒÎ¼Î²Î¿Ï…Ï‚)</h2>
    <small>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® &amp; Î´Î¹Î±Î³ÏÎ±Ï†Î® ÎºÏŒÎ¼Î²Î¿Ï….</small>

    <div class="structure-visual">
      <div class="section-title">Î“ÏÎ±Ï†Î¹ÎºÎ® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚</div>
      <div class="pointers">
        Head: <span id="doubly-head">NULL</span> â€¢ ÎŸÏ…ÏÎ¬ (Tail): <span id="doubly-tail">NULL</span>
      </div>
      <div id="doubly-visual" class="list-visual"></div>
      <div class="hint" id="doubly-selected-label">ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: ÎºÎ±Î½Î­Î½Î±Ï‚</div>
    </div>

    <div class="layout">
      <div class="memory-section">
        <div class="section-title">ÎœÎ½Î®Î¼Î· RAM (Ï€Î»Î­Î³Î¼Î± 5x6)</div>
        <div id="doubly-memory" class="memory-grid"></div>
        <div class="hint">ÎšÎ¬Î¸Îµ ÎºÏŒÎ¼Î²Î¿Ï‚ ÎºÏÎ±Ï„Î¬ÎµÎ¹ prev (Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿) ÎºÎ±Î¹ next (ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿).</div>
      </div>

      <div class="control-section">
        <div class="section-title">Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚</div>

        <div class="controls">
          Î Î»Î®Î¸Î¿Ï‚ ÎºÏŒÎ¼Î²Ï‰Î½:
          <input type="number" id="doubly-count" value="5" min="1" max="10">
          <button class="btn small" id="doubly-init">Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î»Î¯ÏƒÏ„Î±</button>
        </div>

        <div class="controls">
          Î¤Î¹Î¼Î®:
          <input type="number" id="doubly-value" value="77">
          Î˜Î­ÏƒÎ·:
          <select id="doubly-position">
            <option value="head">Î£Ï„Î·Î½ Î±ÏÏ‡Î® Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚</option>
            <option value="after">ÎœÎµÏ„Î¬ Ï„Î¿Î½ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ ÎºÏŒÎ¼Î²Î¿</option>
          </select>
          <button class="btn small" id="doubly-insert">Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÏŒÎ¼Î²Î¿Ï…</button>
        </div>

        <div class="controls">
          <button class="btn small btn-danger" id="doubly-delete">Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…</button>
          <button class="btn small btn-success" id="doubly-clear">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚</button>
        </div>

        <div class="hint">ÎšÎ¬Î½Îµ ÎºÎ»Î¹Îº ÏƒÎµ ÎºÏŒÎ¼Î²Î¿ Î³Î¹Î± ÎµÏ€Î¹Î»Î¿Î³Î®. Î— Î»Î¯ÏƒÏ„Î± Î´Î¹Î±Î²Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Head Ï€ÏÎ¿Ï‚ Tail ÎºÎ±Î¹ Î±Î½Ï„Î¯ÏƒÏ„ÏÎ¿Ï†Î±.</div>

        <div id="doubly-log" class="log">
          <strong>ÎŸÎ´Î·Î³Î¯ÎµÏ‚:</strong> Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï€ÏŒÏƒÎ¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Î¸Î­Î»ÎµÎ¹Ï‚ (1â€“10), Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Ï„Î· Î»Î¯ÏƒÏ„Î± ÎºÎ±Î¹ Ï€Î±ÏÎ±Ï„Î®ÏÎ·ÏƒÎµ
          Ï€ÏÏ‚ Î±Î»Î»Î¬Î¶Î¿Ï…Î½ prev/next ÏŒÏ„Î±Î½ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹Ï‚ Î® Î´Î¹Î±Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚.</div>
      </div>
    </div>
  </section>

  <section class="panel" id="panel-stack">
    <h2>Î†ÏƒÎºÎ·ÏƒÎ·: Î£Ï„Î¿Î¯Î²Î± Î¼Îµ Î±Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± (4 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±)</h2>
    <small>ÎÎ¸Î·ÏƒÎ· (push) ÎºÎ±Î¹ Î±Ï€ÏÎ¸Î·ÏƒÎ· (pop) ÏƒÎµ Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¿Î¯Î²Î±Ï‚.</small>

    <div class="structure-visual">
      <div class="section-title">Î“ÏÎ±Ï†Î¹ÎºÎ® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· ÏƒÏ„Î¿Î¯Î²Î±Ï‚</div>
      <div class="pointers">
        Top: <span id="stack-top">NULL</span>
      </div>
      <div id="stack-visual" class="list-visual"></div>
    </div>

    <div class="layout">
      <div class="memory-section">
        <div class="section-title">ÎœÎ½Î®Î¼Î· RAM Ï„Î·Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ (Ï€Î»Î­Î³Î¼Î± 5x6)</div>
        <div id="stack-memory" class="memory-grid"></div>
        <div class="hint">Î— ÏƒÏ„Î¿Î¯Î²Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Î´Î¹Î¬ÏƒÏ€Î±ÏÏ„Î¿Ï…Ï‚ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·. ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Top ÎºÏÎ±Ï„Î¬ÎµÎ¹ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î®.</div>
      </div>

      <div class="control-section">
        <div class="section-title">Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ (LIFO)</div>

        <div class="controls">
          <button class="btn small" id="stack-init">Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ ÏƒÏ„Î¿Î¯Î²Î± 4 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½</button>
        </div>

        <div class="controls">
          ÎÎ­Î± Ï„Î¹Î¼Î®:
          <input type="number" id="stack-value" value="999">
          <button class="btn small" id="stack-push">ÎÎ¸Î·ÏƒÎ· (Push)</button>
          <button class="btn small secondary" id="stack-pop">Î‘Ï€ÏÎ¸Î·ÏƒÎ· (Pop)</button>
          <button class="btn small btn-success" id="stack-clear">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚</button>
        </div>

        <div class="hint">Î£Ï„Î· ÏƒÏ„Î¿Î¯Î²Î± Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î¼Îµ ÎºÎ±Î¹ Î±Ï†Î±Î¹ÏÎ¿ÏÎ¼Îµ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î¼ÏŒÎ½Î¿ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® (Top).</div>

        <div id="stack-log" class="log">
          <strong>Î•Î¾Î®Î³Î·ÏƒÎ·:</strong> Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ push ÎºÎ±Î¹ pop ÎºÎ±Î¹ Î´Î¹Î¬Î²Î±ÏƒÎµ Ï„Î± Î²Î®Î¼Î±Ï„Î± Ï€Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÎ´Ï Î³Î¹Î± ÎºÎ¬Î¸Îµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±.
        </div>
      </div>
    </div>
  </section>

  <section class="panel" id="panel-queue">
    <h2>Î†ÏƒÎºÎ·ÏƒÎ·: ÎŸÏ…ÏÎ¬ Î¼Îµ Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±</h2>
    <small>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® (enqueue) ÏƒÏ„Î¿ Ï€Î¯ÏƒÏ‰ Î¬ÎºÏÎ¿ ÎºÎ±Î¹ ÎµÎ¾Î±Î³Ï‰Î³Î® (dequeue) Î±Ï€ÏŒ Ï„Î¿ Î¼Ï€ÏÎ¿ÏƒÏ„Î¹Î½ÏŒ Î¬ÎºÏÎ¿.</small>

    <div class="structure-visual">
      <div class="section-title">Î“ÏÎ±Ï†Î¹ÎºÎ® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Î¿Ï…ÏÎ¬Ï‚</div>
      <div class="pointers">
        Front (Head): <span id="queue-front">NULL</span> â€¢ Rear (Tail): <span id="queue-rear">NULL</span>
      </div>
      <div id="queue-visual" class="list-visual"></div>
    </div>

    <div class="layout">
      <div class="memory-section">
        <div class="section-title">ÎœÎ½Î®Î¼Î· RAM Ï„Î·Ï‚ Î¿Ï…ÏÎ¬Ï‚ (Ï€Î»Î­Î³Î¼Î± 5x6)</div>
        <div id="queue-memory" class="memory-grid"></div>
        <div class="hint">Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î´ÏÎ¿ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚: Head/Front (Î¼Ï€ÏÎ¿ÏƒÏ„Î¹Î½ÏŒ Î¬ÎºÏÎ¿) ÎºÎ±Î¹ Rear (Î¿Ï…ÏÎ¬).</div>
      </div>

      <div class="control-section">
        <div class="section-title">Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Î¿Ï…ÏÎ¬Ï‚ (FIFO)</div>

        <div class="controls">
          <button class="btn small" id="queue-init">Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î¿Ï…ÏÎ¬ 4 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½</button>
        </div>

        <div class="controls">
          ÎÎ­Î± Ï„Î¹Î¼Î®:
          <input type="number" id="queue-value" value="500">
          <button class="btn small" id="queue-enqueue">Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® (Enqueue)</button>
          <button class="btn small secondary" id="queue-dequeue">Î•Î¾Î±Î³Ï‰Î³Î® (Dequeue)</button>
          <button class="btn small btn-success" id="queue-clear">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚</button>
        </div>

        <div class="hint">Î£Ï„Î·Î½ Î¿Ï…ÏÎ¬ Î¼Ï€Î±Î¯Î½Î¿Ï…Î¼Îµ Î±Ï€ÏŒ Ï„Î¿ Ï€Î¯ÏƒÏ‰ Î¬ÎºÏÎ¿ (Rear) ÎºÎ±Î¹ Î²Î³Î±Î¯Î½Î¿Ï…Î¼Îµ Î±Ï€ÏŒ Ï„Î¿ Î¼Ï€ÏÎ¿ÏƒÏ„Î¹Î½ÏŒ (Head/Front).</div>

        <div id="queue-log" class="log">
          <strong>Î•Î¾Î®Î³Î·ÏƒÎ·:</strong> ÎšÎ¬Î½Îµ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÎ±Î¹ ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÎºÎ±Î¹ Ï€Î±ÏÎ±Ï„Î®ÏÎ·ÏƒÎµ Ï€ÏÏ‚ Î±Î»Î»Î¬Î¶Î¿Ï…Î½ Î¿Î¹ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚
          Head/Front â€“ Rear ÎºÎ±Î¹ Ï„Î± Ï€ÎµÎ´Î¯Î± prev/next ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.
        </div>
      </div>
    </div>
  </section>

  <section class="panel" id="panel-quiz">
    <h2>Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ Î‘Ï…Ï„Î¿Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ (Î£Ï‰ÏƒÏ„ÏŒ/Î›Î¬Î¸Î¿Ï‚)</h2>
    <small>Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï„Î· ÏƒÏ‰ÏƒÏ„Î® Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎµÏÏÏ„Î·ÏƒÎ·.</small>
    
    <div class="control-section" style="margin-top: 15px;">
        <div id="quiz-container">
            </div>
        
        <div style="margin-top: 20px; display: flex; gap: 10px;">
            <button class="btn btn-success" id="btn-check-quiz">ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÏ‰Î½</button>
            <button class="btn secondary" id="btn-reset-quiz">Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬</button>
        </div>
        
        <div id="quiz-result" class="log" style="display:none; margin-top: 15px;"></div>
    </div>
  </section>
</main>

<script>
  const ANIM_STEP = 4000;      // 4 seconds for insert/pointer animations
  const MEM_ANIM_STEP = 5000;  // 5 seconds for memory animations

  // ====== ÎœÎ½Î®Î¼Î· 5x6 Î¼Îµ Ï„Ï…Ï‡Î±Î¯Î± Ï„ÏÎ¹ÏˆÎ®Ï†Î¹Î± Î²Î¬ÏƒÎ· ======
  function randomBase() {
    return Math.floor(Math.random() * 900) + 100; // 100..999
  }

  function randomValue() {
    return Math.floor(Math.random() * 1999) - 999; // -999..999
  }

  function resetMemory(state) {
    const base = randomBase();
    const total = state.rows * state.cols;
    state.memory = [];
    for (let i = 0; i < total; i++) {
      state.memory.push({
        addr: base + i,
        used: false,
        value: null,
        next: null,
        prev: null
      });
    }
  }

  function allocateCell(state) {
    const freeCells = state.memory.filter(c => !c.used);
    if (freeCells.length === 0) return null;
    const idx = Math.floor(Math.random() * freeCells.length);
    const cell = freeCells[idx];
    cell.used = true;
    cell.next = null;
    cell.prev = null;
    return cell;
  }

  // Ï€Î»Î®ÏÎ·Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ (Î³Î¹Î± reset/clear)
  function freeCell(cell) {
    cell.used = false;
    cell.value = null;
    cell.next = null;
    cell.prev = null;
  }

  // Î±Ï€Î¿Î´Î­ÏƒÎ¼ÎµÏ…ÏƒÎ· Î³Î¹Î± Î¼ÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ® Ï‡ÏÎ®ÏƒÎ· â€“ Î· value ÎœÎ•ÎÎ•Î™
  function releaseCell(cell) {
    cell.used = false;
    cell.next = null;
    cell.prev = null;
  }

  function findCell(state, addr) {
    if (addr === null || addr === undefined) return null;
    return state.memory.find(c => c.addr === addr) || null;
  }

  function renderMemory(state, containerId, mode) {
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    state.memory.forEach(cell => {
      const div = document.createElement("div");
      div.className = "mem-cell" + (cell.used ? " used" : "");
      div.dataset.addr = cell.addr;

      let ptrInfo = "";
      if (cell.used) {
        if (mode === "singly" || mode === "stack") {
          ptrInfo = "next: " + (cell.next === null ? "NULL" : cell.next);
        } else if (mode === "doubly" || mode === "queue") {
          ptrInfo =
            "prev: " + (cell.prev === null ? "NULL" : cell.prev) +
            "<br>next: " + (cell.next === null ? "NULL" : cell.next);
        }
      }

      const valueHtml = cell.value !== null
        ? '<div class="mem-content">' + cell.value + "</div>"
        : '<div class="mem-content">&nbsp;</div>';

      div.innerHTML =
        '<div class="mem-addr">' + cell.addr + "</div>" +
        valueHtml +
        '<div class="mem-ptrs">' + ptrInfo + "</div>";
      container.appendChild(div);
    });
  }

  // ========= Helpers animation =========
  function highlightNodeByAddr(listId, addr, className) {
    if (addr === null || addr === undefined) return;
    const container = document.getElementById(listId);
    const node = container.querySelector('.node[data-addr="' + addr + '"]');
    if (node) {
      node.classList.add(className);
      setTimeout(() => node.classList.remove(className), ANIM_STEP);
    }
  }

  function highlightPointerPart(listId, addr, roleSelector) {
    if (addr === null || addr === undefined) return;
    const container = document.getElementById(listId);
    let selector = '.node[data-addr="' + addr + '"] .pointer-part';
    if (roleSelector) selector += roleSelector;
    const part = container.querySelector(selector);
    if (part) {
      part.classList.add("flash-pointer");
      setTimeout(() => part.classList.remove("flash-pointer"), ANIM_STEP);
    }
  }

  function highlightMemCell(memId, addr) {
    const container = document.getElementById(memId);
    const cell = container.querySelector('.mem-cell[data-addr="' + addr + '"]');
    if (cell) {
      cell.classList.add("flash-delete-mem");
      setTimeout(() => cell.classList.remove("flash-delete-mem"), MEM_ANIM_STEP);
    }
  }

  function markNodeDelete(listId, addr) {
    if (addr === null || addr === undefined) return;
    const container = document.getElementById(listId);
    const node = container.querySelector('.node[data-addr="' + addr + '"]');
    if (node) {
      node.classList.add("delete-mark");
      setTimeout(() => node.classList.remove("delete-mark"), ANIM_STEP);
    }
  }

  // ========= Î“ÎµÎ½Î¹ÎºÎ® renderList Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î´Î¿Î¼Î­Ï‚ =========
  function renderList(state, options) {
    const container = document.getElementById(options.visualId);
    container.innerHTML = "";

    const getStartAddr = () => {
      if (options.mode === "singly") return state.head;
      if (options.mode === "doubly") return state.head;
      if (options.mode === "stack")  return state.top;
      if (options.mode === "queue")  return state.front;
      return null;
    };

    const startAddr = getStartAddr();
    if (startAddr === null || startAddr === undefined) {
      container.textContent = "Î— Î´Î¿Î¼Î® ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î®.";
      return;
    }

    // Pointer ÎºÎ¿Ï…Ï„Î¬ÎºÎ¹ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®
    if (options.mode === "stack") {
      const topAddr = state.top;
      const topBox = document.createElement("div");
      topBox.className = "head-box";
      topBox.innerHTML =
        '<div class="marker-title">Top</div>' +
        '<div class="marker-addr">' + (topAddr === null ? "NULL" : topAddr) + "</div>";
      container.appendChild(topBox);

      if (topAddr !== null) {
        const arrowTop = document.createElement("span");
        arrowTop.className = "arrow";
        arrowTop.textContent = "â†’";
        container.appendChild(arrowTop);
      }
    } else if (options.mode === "singly" || options.mode === "doubly" || options.mode === "queue") {
      let headAddr = null;
      if (options.mode === "queue") {
        headAddr = state.front;
      } else {
        headAddr = state.head;
      }

      const headBox = document.createElement("div");
      headBox.className = "head-box";
      headBox.innerHTML =
        '<div class="marker-title">Head</div>' +
        '<div class="marker-addr">' + (headAddr === null ? "NULL" : headAddr) + "</div>";
      container.appendChild(headBox);

      if (headAddr !== null) {
        const arrowHead = document.createElement("span");
        arrowHead.className = "arrow";
        arrowHead.textContent = "â†’";
        container.appendChild(arrowHead);
      }
    }

    let addr = startAddr;
    let first = true;
    const isDoublyMode = (options.mode === "doubly" || options.mode === "queue");

    while (addr !== null && addr !== undefined) {
      const cell = findCell(state, addr);
      if (!cell) break;

      if (!first) {
        if (isDoublyMode) {
          const arrows = document.createElement("div");
          arrows.className = "double-arrow";
          arrows.innerHTML = "â†’<span>â†</span>";
          container.appendChild(arrows);
        } else {
          const arrow = document.createElement("span");
          arrow.className = "arrow";
          arrow.textContent = "â†’";
          container.appendChild(arrow);
        }
      }

      const nodeDiv = document.createElement("div");
      nodeDiv.className = "node " +
                          (state.selected === addr ? "selected " : "") +
                          (isDoublyMode ? "node-doubly" : "node-singly");
      nodeDiv.dataset.addr = addr;

      let html = '<div class="node-content">';

      if (!isDoublyMode) {
        const nextText = cell.next === null ? "NULL" : cell.next;
        html += '<div class="node-part value-part">' +
                (cell.value !== null ? cell.value : "-") + '</div>';
        html += '<div class="node-part pointer-part" data-role="next">next: ' + nextText + '</div>';
      } else {
        const prevText = cell.prev === null ? "NULL" : cell.prev;
        const nextText = cell.next === null ? "NULL" : cell.next;
        html += '<div class="node-part pointer-part" data-role="prev">' +
                '<div class="pointer-label">prev</div>' +
                '<div class="pointer-addr">' + prevText + '</div>' +
                '</div>';
        html += '<div class="node-part value-part">' +
                (cell.value !== null ? cell.value : "-") + '</div>';
        html += '<div class="node-part pointer-part" data-role="next">' +
                '<div class="pointer-label">next</div>' +
                '<div class="pointer-addr">' + nextText + '</div>' +
                '</div>';
      }

      html += '</div>';
      html += '<div class="addr-label">@' + addr + '</div>';
      nodeDiv.innerHTML = html;

      container.appendChild(nodeDiv);

      first = false;
      addr = cell.next;
    }

    if (options.mode === "doubly") {
      const arrowTail = document.createElement("span");
      arrowTail.className = "arrow";
      arrowTail.textContent = "â†";  // Î²Î­Î»Î¿Ï‚ Ï€ÏÎ¿Ï‚ Ï„Î·Î½ Î¿Ï…ÏÎ¬
      container.appendChild(arrowTail);

      const tailBox = document.createElement("div");
      tailBox.className = "tail-box";
      tailBox.innerHTML =
        '<div class="marker-title">Tail</div>' +
        '<div class="marker-addr">' + (state.tail === null ? "NULL" : state.tail) + "</div>";
      container.appendChild(tailBox);
    }

    if (options.mode === "queue") {
      const arrowRear = document.createElement("span");
      arrowRear.className = "arrow";
      arrowRear.textContent = "â†"; // Ï€ÏÎ¿Ï‚ Ï„Î¿Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÏŒÎ¼Î²Î¿ (Rear)
      container.appendChild(arrowRear);

      const rearBox = document.createElement("div");
      rearBox.className = "tail-box";
      rearBox.innerHTML =
        '<div class="marker-title">Rear</div>' +
        '<div class="marker-addr">' + (state.rear === null ? "NULL" : state.rear) + "</div>";
      container.appendChild(rearBox);
    }
  }

  function setText(id, text) {
    document.getElementById(id).textContent = text;
  }

  function setLog(id, html) {
    document.getElementById(id).innerHTML = html;
  }

  // ====== ÎšÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ ======
  const singlyState = {
    rows: 5,
    cols: 6,
    memory: [],
    head: null,
    selected: null
  };

  const doublyState = {
    rows: 5,
    cols: 6,
    memory: [],
    head: null,
    tail: null,
    selected: null
  };

  const stackState = {
    rows: 5,
    cols: 6,
    memory: [],
    top: null,
    selected: null
  };

  const queueState = {
    rows: 5,
    cols: 6,
    memory: [],
    front: null,
    rear: null,
    selected: null
  };

  // ====== Î‘Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± ======
  function updateSinglySelectedLabel() {
    const txt = singlyState.selected === null
      ? "ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: ÎºÎ±Î½Î­Î½Î±Ï‚"
      : "ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· " + singlyState.selected;
    setText("singly-selected-label", txt);
  }

  function singlyRenderAll() {
    renderMemory(singlyState, "singly-memory", "singly");
    renderList(singlyState, { visualId: "singly-visual", mode: "singly" });
    setText("singly-head", singlyState.head === null ? "NULL" : singlyState.head);
    updateSinglySelectedLabel();
  }

  function singlyInitList() {
    singlyState.memory.forEach(freeCell);
    singlyState.head = null;
    singlyState.selected = null;

    const countInput = document.getElementById("singly-count");
    let count = parseInt(countInput.value, 10);
    if (isNaN(count) || count < 1) count = 1;
    if (count > 10) count = 10;
    countInput.value = count;

    const values = [];
    for (let i = 0; i < count; i++) values.push(randomValue());

    let prevAddr = null;

    values.forEach(v => {
      const cell = allocateCell(singlyState);
      if (!cell) return;
      cell.value = v;
      cell.next = null;

      if (singlyState.head === null) {
        singlyState.head = cell.addr;
      } else {
        const prevCell = findCell(singlyState, prevAddr);
        if (prevCell) prevCell.next = cell.addr;
      }
      prevAddr = cell.addr;
    });

    setLog("singly-log",
      "<strong>Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®:</strong> Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î»Î¯ÏƒÏ„Î± Î¼Îµ " + values.length +
      " ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Î¼Îµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚ Î±Ï€ÏŒ -999 Î­Ï‰Ï‚ 999.");
    singlyRenderAll();
  }

  // --- ÎÎ•Î‘ Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î— Î•Î™Î£Î‘Î“Î©Î“Î—Î£ (Î‘Î Î›Î— Î›Î™Î£Î¤Î‘) ---
  function singlyInsertNode() {
    const value = parseInt(document.getElementById("singly-value").value, 10);
    const posMode = document.getElementById("singly-position").value;
    const newCell = allocateCell(singlyState);

    if (!newCell) {
      setLog("singly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿ ÎºÎµÎ»Î¯ ÏƒÏ„Î· Î¼Î½Î®Î¼Î· Î³Î¹Î± Î½Î­Î¿ ÎºÏŒÎ¼Î²Î¿.");
      singlyRenderAll();
      return;
    }
    newCell.value = value;
    
    let prevCell = null;
    
    // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· state Ï€ÏÏÏ„Î± (Logic)
    if (posMode === "head" || singlyState.head === null) {
      newCell.next = singlyState.head;
      singlyState.head = newCell.addr;
      setLog("singly-log", "<strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®:</strong><ol><li>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÏÎ¿Ï… (ÎºÎ¯Î½Î·ÏƒÎ·).</li><li>Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï….</li><li>Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½.</li></ol>");
    } else {
      if (singlyState.selected === null) {
        setLog("singly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€ÏÏÏ„Î± Î­Î½Î±Î½ ÎºÏŒÎ¼Î²Î¿ (ÎºÎ»Î¹Îº) ÏÏƒÏ„Îµ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î½Î± Î³Î¯Î½ÎµÎ¹ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒÎ½.");
        releaseCell(newCell);
        singlyRenderAll();
        return;
      }
      const prev = findCell(singlyState, singlyState.selected);
      if (!prev) {
        setLog("singly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> ÎŸ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ.");
        releaseCell(newCell);
        singlyRenderAll();
        return;
      }
      newCell.next = prev.next;
      prev.next = newCell.addr;
      prevCell = prev;
      
      setLog("singly-log", "<strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ ÎºÏŒÎ¼Î²Î¿:</strong><ol><li>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÏÎ¿Ï… (ÎºÎ¯Î½Î·ÏƒÎ·).</li><li>Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï….</li><li>Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½.</li></ol>");
    }

    // Render Ï„Î·Î½ Ï„ÎµÎ»Î¹ÎºÎ® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
    singlyRenderAll();

    // Î¤ÏÏÎ± ÎºÎ¬Î½Î¿Ï…Î¼Îµ "rewind" Ï„Î¿ DOM Î³Î¹Î± Ï„Î¿ animation
    const newNodeEl = document.querySelector(`.node[data-addr="${newCell.addr}"]`);
    if (!newNodeEl) return;
    
    // Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Ï…Î¼Îµ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï„Î¿Ï… Î½Î­Î¿Ï… Î´ÎµÎ¯ÎºÏ„Î· ÎºÎ±Î¹ Ï„Î¿ ÎºÏÏÎ²Î¿Ï…Î¼Îµ
    const newPtrEl = newNodeEl.querySelector('[data-role="next"]');
    const finalNewPtrText = newPtrEl.textContent;
    newPtrEl.textContent = "next: ...";

    let prevPtrEl = null;
    let finalPrevPtrText = "";
    
    if (prevCell) {
        const prevNodeEl = document.querySelector(`.node[data-addr="${prevCell.addr}"]`);
        if (prevNodeEl) {
            prevPtrEl = prevNodeEl.querySelector('[data-role="next"]');
            finalPrevPtrText = prevPtrEl.textContent;
            prevPtrEl.textContent = "next: ..."; // ÎšÏÏÎ²Î¿Ï…Î¼Îµ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ Ï„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î· Ï„Î¿Ï… Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï…
        }
    }

    // Î‘ÏÏ‡Î¹ÎºÎ® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· animation (ÏƒÏ…Î¼Ï€Î¹ÎµÏƒÎ¼Î­Î½Î¿Ï‚/Î±ÏŒÏÎ±Ï„Î¿Ï‚)
    newNodeEl.style.maxWidth = "0px";
    newNodeEl.style.padding = "0px";
    newNodeEl.style.borderWidth = "0px";
    newNodeEl.style.opacity = "0";
    newNodeEl.style.overflow = "hidden";
    newNodeEl.style.transition = "all 1.5s ease-out";

    // Trigger reflow
    void newNodeEl.offsetWidth;

    // 1. Animation Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ·Ï‚ (Î±Î½Î¿Î¯Î³ÎµÎ¹ Ï‡ÏÏÎ¿)
    setTimeout(() => {
        newNodeEl.style.maxWidth = "140px"; // Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿ ÎºÎ±Î½Î¿Î½Î¹ÎºÏŒ
        newNodeEl.style.padding = "10px 12px";
        newNodeEl.style.borderWidth = "3px";
    }, 100);

    // 2. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎºÏŒÎ¼Î²Î¿Ï… (fade in) Ï‡Ï‰ÏÎ¯Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚
    setTimeout(() => {
        newNodeEl.style.opacity = "1";
    }, 1600); // Î‘Ï†Î¿Ï Î±Î½Î¿Î¯Î¾ÎµÎ¹ Î¿ Ï‡ÏÏÎ¿Ï‚

    // 3. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¯ÎºÏ„Î· Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï… (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹)
    setTimeout(() => {
        if (prevCell && prevPtrEl) {
            prevPtrEl.textContent = finalPrevPtrText;
            prevPtrEl.classList.add("flash-pointer");
            setTimeout(()=>prevPtrEl.classList.remove("flash-pointer"), 1000);
        }
    }, 3000);

    // 4. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¯ÎºÏ„Î· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…
    setTimeout(() => {
        newPtrEl.textContent = finalNewPtrText;
        newPtrEl.classList.add("flash-pointer");
        setTimeout(()=>newPtrEl.classList.remove("flash-pointer"), 1000);
        
        highlightMemCell("singly-memory", newCell.addr);
    }, 4500);
  }

  // --- Î¤Î¡ÎŸÎ ÎŸÎ ÎŸÎ™Î—ÎœÎ•ÎÎ— Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î— Î”Î™Î‘Î“Î¡Î‘Î¦Î—Î£ (Î‘Î Î›Î— Î›Î™Î£Î¤Î‘) ---
  function singlyDeleteNode() {
    if (singlyState.head === null) {
      setLog("singly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î— Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î®.");
      return;
    }
    if (singlyState.selected === null) {
      setLog("singly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€ÏÏÏ„Î± Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ Ï€Î¿Ï… Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ (ÎºÎ»Î¹Îº).");
      return;
    }

    const targetAddr = singlyState.selected;
    const targetCell = findCell(singlyState, targetAddr);
    if (!targetCell) {
      setLog("singly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> ÎŸ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.");
      return;
    }

    // Î’ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Ï„Î¿ DOM element Î³Î¹Î± Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î± animations
    const container = document.getElementById("singly-visual");
    const nodeEl = container.querySelector('.node[data-addr="' + targetAddr + '"]');

    if (!nodeEl) return;

    // 1. Î’Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Î§ ÎºÎ±Î¹ Î¾ÎµÎºÎ¹Î½Î¬Î¼Îµ Ï„Î¿ ÏƒÎ²Î®ÏƒÎ¹Î¼Î¿ (Opacity -> 0)
    nodeEl.classList.add("delete-mark");

    setLog("singly-log", "<strong>Î”Î¹Î±Î³ÏÎ±Ï†Î®:</strong> ÎŸ ÎºÏŒÎ¼Î²Î¿Ï‚ Î¼Î±ÏÎºÎ¬ÏÎµÏ„Î±Î¹ ÎºÎ±Î¹ Î´Î¹Î±Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Î»Î¿Î³Î¹ÎºÎ¬...");

    // 2. ÎœÎµÏ„Î¬ Î±Ï€ÏŒ 1.5 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±, Î¾ÎµÎºÎ¹Î½Î¬Î¼Îµ Ï„Î·Î½ "Î­Î½Ï‰ÏƒÎ·" (slide)
    setTimeout(() => {
        nodeEl.classList.add("node-collapse");
    }, 1500);

    // 3. Î‘Ï†Î¿Ï Ï„ÎµÎ»ÎµÎ¹ÏÏƒÎµÎ¹ ÎºÎ±Î¹ Î· Î­Î½Ï‰ÏƒÎ· (ÏƒÏÎ½Î¿Î»Î¿ Ï€ÎµÏÎ¯Ï€Î¿Ï… 4 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±), ÎµÎ½Î·Î¼ÎµÏÏÎ½Î¿Ï…Î¼Îµ Ï„Î· Î¼Î½Î®Î¼Î·
    setTimeout(() => {
        // Î›Î¿Î³Î¹ÎºÎ® ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·Ï‚ Î´ÎµÎ¹ÎºÏ„ÏÎ½ (Î¯Î´Î¹Î± Î¼Îµ Ï€ÏÎ¹Î½)
        if (targetAddr === singlyState.head) {
             singlyState.head = targetCell.next;
             setLog("singly-log", "<strong>ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·:</strong> Î— Head Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®Î¸Î·ÎºÎµ. ÎŸ Ï€Î±Î»Î¹ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï‚ ÎµÎ»ÎµÏ…Î¸ÎµÏÏÎ¸Î·ÎºÎµ.");
        } else {
             let prevAddr = singlyState.head;
             let prevCell = findCell(singlyState, prevAddr);
             while (prevCell && prevCell.next !== targetAddr) {
                prevAddr = prevCell.next;
                prevCell = findCell(singlyState, prevAddr);
             }
             if (prevCell) {
                 prevCell.next = targetCell.next;
                 // Highlight Ï„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î· Ï„Î¿Ï… Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï… Ï€Î¿Ï… Î¬Î»Î»Î±Î¾Îµ
                 setTimeout(() => {
                    highlightPointerPart("singly-visual", prevAddr, '[data-role="next"]');
                 }, 500);
                 setLog("singly-log", "<strong>ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·:</strong> ÎŸÎ¹ Î³ÎµÎ¹Ï„Î¿Î½Î¹ÎºÎ¿Î¯ ÎºÏŒÎ¼Î²Î¿Î¹ ÎµÎ½ÏÎ¸Î·ÎºÎ±Î½. ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ.");
             }
        }

        // ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚ ÎºÎ±Î¹ UI
        releaseCell(targetCell);
        singlyState.selected = null;
        singlyRenderAll(); // Î•Î´Ï Î¾Î±Î½Î±Î¶Ï‰Î³ÏÎ±Ï†Î¯Î¶ÎµÏ„Î±Î¹ Î· Î»Î¯ÏƒÏ„Î± ÎµÎ½Ï‰Î¼Î­Î½Î·
        
        // Flash ÏƒÏ„Î· Î¼Î½Î®Î¼Î· RAM ÏŒÏ„Î¹ ÎµÎ»ÎµÏ…Î¸ÎµÏÏÎ¸Î·ÎºÎµ
        highlightMemCell("singly-memory", targetAddr);

    }, 4000); // Î ÎµÏÎ¹Î¼Î­Î½Î¿Ï…Î¼Îµ ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ¬ 4s Î³Î¹Î± Ï„Î± animations
  }

  function singlyClear() {
    resetMemory(singlyState);
    singlyState.head = null;
    singlyState.selected = null;
    setLog("singly-log", "<strong>ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚:</strong> Î— Î»Î¯ÏƒÏ„Î± Î¬Î´ÎµÎ¹Î±ÏƒÎµ ÎºÎ±Î¹ Î· RAM Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Î½Î­Î¿ Ï„Ï…Ï‡Î±Î¯Î¿ Ï„ÏÎ¹ÏˆÎ®Ï†Î¹Î¿.");
    singlyRenderAll();
  }

  // ====== Î”Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± ======
  function updateDoublySelectedLabel() {
    const txt = doublyState.selected === null
      ? "ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: ÎºÎ±Î½Î­Î½Î±Ï‚"
      : "ğŸ’¡ Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚: Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· " + doublyState.selected;
    setText("doubly-selected-label", txt);
  }

  function doublyRenderAll() {
    renderMemory(doublyState, "doubly-memory", "doubly");
    renderList(doublyState, { visualId: "doubly-visual", mode: "doubly" });
    setText("doubly-head", doublyState.head === null ? "NULL" : doublyState.head);
    setText("doubly-tail", doublyState.tail === null ? "NULL" : doublyState.tail);
    updateDoublySelectedLabel();
  }

  function doublyInitList() {
    doublyState.memory.forEach(freeCell);
    doublyState.head = null;
    doublyState.tail = null;
    doublyState.selected = null;

    const countInput = document.getElementById("doubly-count");
    let count = parseInt(countInput.value, 10);
    if (isNaN(count) || count < 1) count = 1;
    if (count > 10) count = 10;
    countInput.value = count;

    const values = [];
    for (let i = 0; i < count; i++) values.push(randomValue());

    let prevAddr = null;

    values.forEach(v => {
      const cell = allocateCell(doublyState);
      if (!cell) return;
      cell.value = v;
      cell.next = null;
      cell.prev = prevAddr;

      if (doublyState.head === null) {
        doublyState.head = cell.addr;
      } else {
        const prevCell = findCell(doublyState, prevAddr);
        if (prevCell) prevCell.next = cell.addr;
      }
      prevAddr = cell.addr;
    });

    doublyState.tail = prevAddr;

    setLog("doubly-log",
      "<strong>Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®:</strong> Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± " + values.length +
      " ÎºÏŒÎ¼Î²Ï‰Î½ Î¼Îµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚ Î±Ï€ÏŒ -999 Î­Ï‰Ï‚ 999.");
    doublyRenderAll();
  }

  // --- ÎÎ•Î‘ Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î— Î•Î™Î£Î‘Î“Î©Î“Î—Î£ (Î”Î™Î Î›Î— Î›Î™Î£Î¤Î‘) ---
  function doublyInsertNode() {
    const value = parseInt(document.getElementById("doubly-value").value, 10);
    const posMode = document.getElementById("doubly-position").value;
    const newCell = allocateCell(doublyState);

    if (!newCell) {
      setLog("doubly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿ ÎºÎµÎ»Î¯ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.");
      doublyRenderAll();
      return;
    }
    newCell.value = value;
    newCell.next = null;
    newCell.prev = null;

    let prevCell = null;
    let nextCell = null;

    // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Logic State
    if (posMode === "head" || doublyState.head === null) {
      newCell.next = doublyState.head;
      newCell.prev = null;
      if (doublyState.head !== null) {
        const oldHead = findCell(doublyState, doublyState.head);
        if (oldHead) {
            oldHead.prev = newCell.addr;
            nextCell = oldHead;
        }
      }
      doublyState.head = newCell.addr;
      if (doublyState.tail === null) {
        doublyState.tail = newCell.addr;
      }
      setLog("doubly-log", "<strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®:</strong><ol><li>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÏÎ¿Ï….</li><li>Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï….</li><li>Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½.</li></ol>");
    } else {
      if (doublyState.selected === null) {
        setLog("doubly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€ÏÏÏ„Î± ÎºÏŒÎ¼Î²Î¿ ÏÏƒÏ„Îµ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î½Î± Î³Î¯Î½ÎµÎ¹ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒÎ½.");
        releaseCell(newCell);
        doublyRenderAll();
        return;
      }

      const prev = findCell(doublyState, doublyState.selected);
      if (!prev) {
        setLog("doubly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> ÎŸ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ.");
        releaseCell(newCell);
        doublyRenderAll();
        return;
      }
      prevCell = prev;
      const nextAddr = prev.next;
      
      newCell.prev = prev.addr;
      newCell.next = nextAddr;
      prev.next = newCell.addr;

      if (nextAddr !== null) {
        const next = findCell(doublyState, nextAddr);
        if (next) {
            next.prev = newCell.addr;
            nextCell = next;
        }
      } else {
        doublyState.tail = newCell.addr;
      }
      
      setLog("doubly-log", "<strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ ÎºÏŒÎ¼Î²Î¿:</strong><ol><li>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÏÎ¿Ï….</li><li>Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï….</li><li>Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½.</li></ol>");
    }

    // Render Ï„Î·Î½ Ï„ÎµÎ»Î¹ÎºÎ® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
    doublyRenderAll();

    // -- Animation Rewind --
    const newNodeEl = document.querySelector(`.node[data-addr="${newCell.addr}"]`);
    if (!newNodeEl) return;
    
    // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·/ÎšÏÏÏˆÎ¹Î¼Î¿ Î´ÎµÎ¹ÎºÏ„ÏÎ½ Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…
    const newPrevPtr = newNodeEl.querySelector('[data-role="prev"]');
    const newNextPtr = newNodeEl.querySelector('[data-role="next"]');
    const finalNewPrev = newPrevPtr.innerHTML;
    const finalNewNext = newNextPtr.innerHTML;
    newPrevPtr.innerHTML = '<div class="pointer-label">prev</div><div class="pointer-addr">...</div>';
    newNextPtr.innerHTML = '<div class="pointer-label">next</div><div class="pointer-addr">...</div>';

    let prevNextPtr = null; // prevNode.next
    let finalPrevNextText = "";
    if (prevCell) {
        const pEl = document.querySelector(`.node[data-addr="${prevCell.addr}"]`);
        if (pEl) {
            prevNextPtr = pEl.querySelector('[data-role="next"]');
            finalPrevNextText = prevNextPtr.innerHTML;
            prevNextPtr.innerHTML = '<div class="pointer-label">next</div><div class="pointer-addr">...</div>';
        }
    }

    let nextPrevPtr = null; // nextNode.prev
    let finalNextPrevText = "";
    if (nextCell) {
        const nEl = document.querySelector(`.node[data-addr="${nextCell.addr}"]`);
        if (nEl) {
            nextPrevPtr = nEl.querySelector('[data-role="prev"]');
            finalNextPrevText = nextPrevPtr.innerHTML;
            nextPrevPtr.innerHTML = '<div class="pointer-label">prev</div><div class="pointer-addr">...</div>';
        }
    }

    // Î‘ÏÏ‡Î¹ÎºÎ® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· animation (ÏƒÏ…Î¼Ï€Î¹ÎµÏƒÎ¼Î­Î½Î¿Ï‚/Î±ÏŒÏÎ±Ï„Î¿Ï‚)
    newNodeEl.style.maxWidth = "0px";
    newNodeEl.style.minWidth = "0px"; // Important override
    newNodeEl.style.padding = "0px";
    newNodeEl.style.borderWidth = "0px";
    newNodeEl.style.opacity = "0";
    newNodeEl.style.overflow = "hidden";
    newNodeEl.style.transition = "all 1.5s ease-out";

    void newNodeEl.offsetWidth; // Force Reflow

    // 1. ÎœÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ· (Space creation)
    setTimeout(() => {
        newNodeEl.style.maxWidth = "100%"; // Allow full width
        newNodeEl.style.minWidth = "130px"; // Restore min-width
        newNodeEl.style.padding = "10px 12px";
        newNodeEl.style.borderWidth = "3px";
    }, 100);

    // 2. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎºÏŒÎ¼Î²Î¿Ï… (Fade in)
    setTimeout(() => {
        newNodeEl.style.opacity = "1";
    }, 1600);

    // 3. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½ Ï„Ï‰Î½ Î“ÎµÎ¹Ï„ÏŒÎ½Ï‰Î½
    setTimeout(() => {
        if (prevNextPtr) {
            prevNextPtr.innerHTML = finalPrevNextText;
            prevNextPtr.classList.add("flash-pointer");
            setTimeout(()=>prevNextPtr.classList.remove("flash-pointer"), 1000);
        }
        if (nextPrevPtr) {
            nextPrevPtr.innerHTML = finalNextPrevText;
            nextPrevPtr.classList.add("flash-pointer");
            setTimeout(()=>nextPrevPtr.classList.remove("flash-pointer"), 1000);
        }
    }, 3000);

    // 4. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î´ÎµÎ¹ÎºÏ„ÏÎ½ Ï„Î¿Ï… ÎÎ­Î¿Ï… ÎšÏŒÎ¼Î²Î¿Ï…
    setTimeout(() => {
        newPrevPtr.innerHTML = finalNewPrev;
        newNextPtr.innerHTML = finalNewNext;
        
        newPrevPtr.classList.add("flash-pointer");
        newNextPtr.classList.add("flash-pointer");
        setTimeout(()=>{
            newPrevPtr.classList.remove("flash-pointer");
            newNextPtr.classList.remove("flash-pointer");
        }, 1000);

        highlightMemCell("doubly-memory", newCell.addr);
    }, 4500);
  }

  // --- Î¤Î¡ÎŸÎ ÎŸÎ ÎŸÎ™Î—ÎœÎ•ÎÎ— Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î— Î”Î™Î‘Î“Î¡Î‘Î¦Î—Î£ (Î”Î™Î Î›Î— Î›Î™Î£Î¤Î‘) ---
  function doublyDeleteNode() {
    if (doublyState.head === null) {
      setLog("doubly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î— Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î®.");
      return;
    }
    if (doublyState.selected === null) {
      setLog("doubly-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€ÏÏÏ„Î± Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ Ï€Î¿Ï… Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚.");
      return;
    }

    const targetAddr = doublyState.selected;
    const target = findCell(doublyState, targetAddr);
    if (!target) {
      setLog("doubly-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> ÎŸ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.");
      return;
    }

    // Î’ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Ï„Î¿ DOM element
    const container = document.getElementById("doubly-visual");
    const nodeEl = container.querySelector('.node[data-addr="' + targetAddr + '"]');
    if (!nodeEl) return;

    // 1. ÎœÎµÎ³Î¬Î»Î¿ Î§ ÎºÎ±Î¹ ÏƒÎ²Î®ÏƒÎ¹Î¼Î¿
    nodeEl.classList.add("delete-mark");
    setLog("doubly-log", "<strong>Î”Î¹Î±Î³ÏÎ±Ï†Î®:</strong> ÎŸ ÎºÏŒÎ¼Î²Î¿Ï‚ Î´Î¹Î±Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹. ÎŸÎ¹ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ Î¸Î± ÎµÎ½Î·Î¼ÎµÏÏ‰Î¸Î¿ÏÎ½...");

    // 2. ÎˆÎ½Ï‰ÏƒÎ· ÎºÏŒÎ¼Î²Ï‰Î½ (Slide)
    setTimeout(() => {
        nodeEl.classList.add("node-collapse");
    }, 1500);

    // 3. Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚ ÎºÎ±Î¹ Î´ÎµÎ¹ÎºÏ„ÏÎ½
    setTimeout(() => {
      const prevAddr = target.prev;
      const nextAddr = target.next;
      const prev = findCell(doublyState, prevAddr);
      const next = findCell(doublyState, nextAddr);

      if (prev) prev.next = nextAddr;
      if (next) next.prev = prevAddr;

      if (targetAddr === doublyState.head) doublyState.head = nextAddr;
      if (targetAddr === doublyState.tail) doublyState.tail = prevAddr;

      releaseCell(target);
      doublyState.selected = null;
      if (doublyState.head === null) doublyState.tail = null;

      doublyRenderAll(); // ÎÎ±Î½Î±Î¶Ï‰Î³ÏÎ±Ï†Î¯Î¶Î¿Ï…Î¼Îµ Ï„Î· Î»Î¯ÏƒÏ„Î±
      highlightMemCell("doubly-memory", targetAddr);

      // Î‘Î½Î±Î²ÏŒÏƒÎ²Î·ÏƒÎ¼Î± Î´ÎµÎ¹ÎºÏ„ÏÎ½ (flash) ÏƒÏ„Î¿Ï…Ï‚ Î³ÎµÎ¯Ï„Î¿Î½ÎµÏ‚
      if (prevAddr !== null) {
          highlightPointerPart("doubly-visual", prevAddr, '[data-role="next"]');
      }
      if (nextAddr !== null) {
          // ÎœÎ¹ÎºÏÎ® ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ· Î³Î¹Î± Î½Î± Ï†Î±Î½ÎµÎ¯ Î· Î±Î»Î»Î·Î»Î¿Ï…Ï‡Î¯Î± Î±Î½ Î¸Î­Î»Î¿Ï…Î¼Îµ, Î® Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±
          setTimeout(() => {
            highlightPointerPart("doubly-visual", nextAddr, '[data-role="prev"]');
          }, 200);
      }
      
      setLog("doubly-log", "<strong>ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·:</strong> Î— Î´Î¹Î±Î³ÏÎ±Ï†Î® Ï„ÎµÎ»ÎµÎ¯Ï‰ÏƒÎµ. ÎŸÎ¹ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ prev/next Ï„Ï‰Î½ Î³ÎµÎ¹Ï„ÏŒÎ½Ï‰Î½ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎ±Î½.");

    }, 4000); // 4 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î± Î±Î½Î±Î¼Î¿Î½Î®
  }

  function doublyClear() {
    resetMemory(doublyState);
    doublyState.head = null;
    doublyState.tail = null;
    doublyState.selected = null;
    setLog("doubly-log", "<strong>ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚:</strong> Î— Î»Î¯ÏƒÏ„Î± Î¬Î´ÎµÎ¹Î±ÏƒÎµ ÎºÎ±Î¹ Î· RAM Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Î½Î­Î¿ Ï„Ï…Ï‡Î±Î¯Î¿ Ï„ÏÎ¹ÏˆÎ®Ï†Î¹Î¿.");
    doublyRenderAll();
  }

  // ====== Î£Ï„Î¿Î¯Î²Î± ======
  function stackRenderAll() {
    renderMemory(stackState, "stack-memory", "stack");
    renderList(stackState, { visualId: "stack-visual", mode: "stack" });
    setText("stack-top", stackState.top === null ? "NULL" : stackState.top);
  }

  function stackInit() {
    stackState.memory.forEach(freeCell);
    stackState.top = null;

    const values = [randomValue(), randomValue(), randomValue(), randomValue()];
    values.forEach(v => {
      const cell = allocateCell(stackState);
      if (!cell) return;
      cell.value = v;
      cell.next = stackState.top;
      stackState.top = cell.addr;
    });

    setLog("stack-log",
      "<strong>Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¿Î¯Î²Î±Ï‚:</strong> Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ ÏƒÏ„Î¿Î¯Î²Î± 4 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ Î¼Îµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚.");
    stackRenderAll();
  }

  function stackPush() {
    const value = parseInt(document.getElementById("stack-value").value, 10);
    const cell = allocateCell(stackState);
    if (!cell) {
      setLog("stack-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ· Î¼Î½Î®Î¼Î· Î³Î¹Î± Î½Î­Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿.");
      stackRenderAll();
      return;
    }
    cell.value = value;
    cell.next = stackState.top;
    stackState.top = cell.addr;

    setLog("stack-log",
      "<strong>ÎÎ¸Î·ÏƒÎ· (push) " + value + ":</strong>" +
      "<ol>" +
      "<li>Î”ÎµÏƒÎ¼ÎµÏÏ‰ Î½Î­Î¿ ÎºÎµÎ»Î¯ ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ‰ Ï„Î·Î½ Ï„Î¹Î¼Î®.</li>" +
      "<li>Î¤Î¿ next Ï„Î¿Ï… Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î·Î½ Ï€Î±Î»Î¹Î¬ ÎºÎ¿ÏÏ…Ï†Î®.</li>" +
      "<li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Top ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÏ„Î±Î¹.</li>" +
      "</ol>");

    stackRenderAll();
    highlightNodeByAddr("stack-visual", stackState.top, "flash-insert");

    setTimeout(() => {
      highlightMemCell("stack-memory", stackState.top);
    }, ANIM_STEP * 2);
  }

  function stackPop() {
    if (stackState.top === null) {
      setLog("stack-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î— ÏƒÏ„Î¿Î¯Î²Î± ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î® (Underflow).");
      return;
    }
    const cell = findCell(stackState, stackState.top);
    const oldAddr = stackState.top;
    const val = cell.value;

    setLog("stack-log",
      "<strong>Î‘Ï€ÏÎ¸Î·ÏƒÎ· (pop) " + val + ":</strong>" +
      "<ol>" +
      "<li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Top Î¸Î± Î¼ÎµÏ„Î±ÎºÎ¹Î½Î·Î¸ÎµÎ¯ ÏƒÏ„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÏŒÎ¼Î²Î¿.</li>" +
      "<li>ÎŸ Ï€Î±Î»Î¹ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î¼Î­Î½ÎµÎ¹ Ï‰Ï‚ Â«Î¬Ï‡ÏÎ·ÏƒÏ„Î¿ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿Â» ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.</li>" +
      "</ol>");

    markNodeDelete("stack-visual", oldAddr);

    setTimeout(() => {
      stackState.top = cell.next;
      releaseCell(cell);
      stackRenderAll();
      highlightMemCell("stack-memory", oldAddr);
    }, ANIM_STEP);
  }

  function stackClear() {
    resetMemory(stackState);
    stackState.top = null;
    setLog("stack-log", "<strong>ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚:</strong> Î— ÏƒÏ„Î¿Î¯Î²Î± Î¬Î´ÎµÎ¹Î±ÏƒÎµ ÎºÎ±Î¹ Î· RAM Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Î½Î­Î¿ Ï„ÏÎ¹ÏˆÎ®Ï†Î¹Î¿.");
    stackRenderAll();
  }

  // ====== ÎŸÏ…ÏÎ¬ ======
  function queueRenderAll() {
    renderMemory(queueState, "queue-memory", "queue");
    renderList(queueState, { visualId: "queue-visual", mode: "queue" });
    setText("queue-front", queueState.front === null ? "NULL" : queueState.front);
    setText("queue-rear", queueState.rear === null ? "NULL" : queueState.rear);
  }

  function queueEnqueueInternal(value, explain) {
    const cell = allocateCell(queueState);
    if (!cell) {
      if (explain) {
        setLog("queue-log", "<strong>Î£Ï†Î¬Î»Î¼Î±:</strong> Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ· Î¼Î½Î®Î¼Î· Î³Î¹Î± Î½Î­Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Î¿Ï…ÏÎ¬Ï‚.");
        queueRenderAll();
      }
      return false;
    }
    cell.value = value;
    cell.next = null;
    cell.prev = queueState.rear;

    if (queueState.rear !== null) {
      const oldRear = findCell(queueState, queueState.rear);
      if (oldRear) oldRear.next = cell.addr;
    }
    queueState.rear = cell.addr;
    if (queueState.front === null) {
      queueState.front = cell.addr;
    }

    if (explain) {
      setLog("queue-log",
        "<strong>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® (enqueue) " + value + ":</strong>" +
        "<ol>" +
        "<li>Î”ÎµÏƒÎ¼ÎµÏÏ‰ Î½Î­Î¿ ÎºÎµÎ»Î¯ ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ‰ Ï„Î·Î½ Ï„Î¹Î¼Î®.</li>" +
        "<li>Î¤Î¿ prev Ï„Î¿Ï… Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î¿ Ï€Î±Î»Î¹ÏŒ Rear.</li>" +
        "<li>Î¤Î¿ next Ï„Î¿Ï… Ï€Î±Î»Î¹Î¿Ï Rear ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÏ„Î±Î¹ ÏÏƒÏ„Îµ Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î¿Î½ Î½Î­Î¿ ÎºÏŒÎ¼Î²Î¿.</li>" +
        "<li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Rear ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ„Î¿Î½ Î½Î­Î¿ ÎºÏŒÎ¼Î²Î¿.</li>" +
        "</ol>");
    }
    return true;
  }

  function queueInit() {
    queueState.memory.forEach(freeCell);
    queueState.front = null;
    queueState.rear = null;

    const values = [randomValue(), randomValue(), randomValue(), randomValue()];
    values.forEach(v => queueEnqueueInternal(v, false));

    setLog("queue-log",
      "<strong>Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î¿Ï…ÏÎ¬Ï‚:</strong> Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î¿Ï…ÏÎ¬ 4 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ Î¼Îµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚.");
    queueRenderAll();
  }

  function queueEnqueue() {
    const value = parseInt(document.getElementById("queue-value").value, 10);
    if (queueEnqueueInternal(value, true)) {
      queueRenderAll();
      highlightNodeByAddr("queue-visual", queueState.rear, "flash-insert");

      setTimeout(() => {
        if (queueState.rear !== null) {
          highlightPointerPart("queue-visual", queueState.rear, '[data-role="prev"]');
        }
      }, ANIM_STEP);

      setTimeout(() => {
        if (queueState.rear !== null) {
          highlightMemCell("queue-memory", queueState.rear);
        }
      }, ANIM_STEP * 2);
    }
  }

  function queueDequeue() {
    if (queueState.front === null) {
      setLog("queue-log", "<strong>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</strong> Î— Î¿Ï…ÏÎ¬ ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î® (Underflow).");
      return;
    }
    const cell = findCell(queueState, queueState.front);
    const oldFront = queueState.front;
    const newFrontAddr = cell.next;
    const val = cell.value;

    setLog("queue-log",
      "<strong>Î•Î¾Î±Î³Ï‰Î³Î® (dequeue) " + val + ":</strong>" +
      "<ol>" +
      "<li>Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ X ÏƒÏ„Î¿Î½ Ï€ÏÏÏ„Î¿ ÎºÏŒÎ¼Î²Î¿.</li>" +
      "<li>ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Head/Front Î¸Î± Î¼ÎµÏ„Î±ÎºÎ¹Î½Î·Î¸ÎµÎ¯ ÏƒÏ„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÏŒÎ¼Î²Î¿.</li>" +
      "<li>ÎŸ Ï€Î±Î»Î¹ÏŒÏ‚ Ï€ÏÏÏ„Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î¼Î­Î½ÎµÎ¹ Ï‰Ï‚ Â«Î¬Ï‡ÏÎ·ÏƒÏ„Î¿ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿Â» ÏƒÏ„Î· Î¼Î½Î®Î¼Î·.</li>" +
      "</ol>");

    markNodeDelete("queue-visual", oldFront);

    setTimeout(() => {
      queueState.front = newFrontAddr;
      if (newFrontAddr !== null) {
        const newFront = findCell(queueState, newFrontAddr);
        if (newFront) newFront.prev = null;
      } else {
        queueState.rear = null;
      }
      releaseCell(cell);
      queueRenderAll();
      highlightMemCell("queue-memory", oldFront);
    }, ANIM_STEP);
  }

  function queueClear() {
    resetMemory(queueState);
    queueState.front = null;
    queueState.rear = null;
    setLog("queue-log", "<strong>ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Î½Î®Î¼Î·Ï‚:</strong> Î— Î¿Ï…ÏÎ¬ Î¬Î´ÎµÎ¹Î±ÏƒÎµ ÎºÎ±Î¹ Î· RAM Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Î½Î­Î¿ Ï„ÏÎ¹ÏˆÎ®Ï†Î¹Î¿.");
    queueRenderAll();
  }
  
  // ====== Quiz ======
  const quizQuestions = [
    { q: "Î— ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î´Î¿Î¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î±Î¸ÎµÏÎ¿Ï Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚.", a: false },
    { q: "Î‘Î½ Î¿ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ 'ÎšÎµÏ†Î±Î»Î®' Î¼Î¹Î±Ï‚ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ Î­Ï‡ÎµÎ¹ Ï„Î·Î½ Ï„Î¹Î¼Î® NULL, Ï„ÏŒÏ„Îµ Î· Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î®.", a: true },
    { q: "ÎšÎ±Ï„Î¬ Ï„Î· Î´Î¹Î±Î³ÏÎ±Ï†Î® ÎµÎ½ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï… Î±Ï€ÏŒ Î¼Î¯Î± Î»Î¯ÏƒÏ„Î±, Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒÎ½ ÎºÏŒÎ¼Î²Î¿Ï‚.", a: true },
    { q: "Î‘Î½ Ï‡Î±Î¸ÎµÎ¯ Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ ÎºÏŒÎ¼Î²Ï‰Î½ Î¼Î¹Î±Ï‚ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚, Ï„ÏŒÏ„Îµ Î±Ï…Ï„Î® Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏƒÏ„ÎµÎ¯ (Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ Ï„Î¼Î®Î¼Î±).", a: true },
    { q: "ÎšÎ¬Î¸Îµ ÎºÏŒÎ¼Î²Î¿Ï‚ Î¼Î¹Î±Ï‚ Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Î´ÏÎ¿ Ï€ÎµÎ´Î¯Î±: Î”ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ Î”ÎµÎ¯ÎºÏ„Î·.", a: false },
    { q: "Î£Îµ Î¼Î¹Î± ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±, Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÎµÎ½ÏŒÏ‚ Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Î­Î½Î±Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿ ÎºÏŒÎ¼Î²Î¿ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï„Î·Î½ Î±Î»Î»Î±Î³Î® Ï„Î¿Ï… Î´ÎµÎ¯ÎºÏ„Î· Ï„Î¿Ï… Î´ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï….", a: true },
    { q: "Î£Îµ Î¼Î¹Î± Î±Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±, Î· Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎµÎ½ÏŒÏ‚ Î½Î­Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï„Î·Î½ Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï…Ï€Î±ÏÏ‡ÏŒÎ½Ï„Ï‰Î½ ÎºÏŒÎ¼Î²Ï‰Î½ ÏƒÎµ Î½Î­ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Î¼Î½Î®Î¼Î·Ï‚.", a: false },
    { q: "ÎŸÎ¹ ÎºÏŒÎ¼Î²Î¿Î¹ Î¼Î¹Î±Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î½ Î¿Î½ÏŒÎ¼Î±Ï„Î±, Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ Î¼ÏŒÎ½Î¿ Ï„Î¹Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï…Ï‚.", a: true },
    { q: "ÎŸÎ¹ Î»Î¯ÏƒÏ„ÎµÏ‚ Î­Ï‡Î¿Ï…Î½ Ï„Î¿ Ï€Î»ÎµÎ¿Î½Î­ÎºÏ„Î·Î¼Î± (Î­Î½Î±Î½Ï„Î¹ Ï„Ï‰Î½ Ï€Î¹Î½Î¬ÎºÏ‰Î½) Ï„Î·Ï‚ ÎµÏ…ÎºÎ¿Î»Î¯Î±Ï‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ ÎºÎ±Î¹ Î´Î¹Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½.", a: true },
    { q: "Î”ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Îµ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒ Ï„ÏÏŒÏ€Î¿ Î´Ï…Î±Î´Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÎµ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½ÎµÏ‚ Î»Î¯ÏƒÏ„ÎµÏ‚.", a: true }
  ];

  function renderQuiz() {
    const container = document.getElementById("quiz-container");
    container.innerHTML = "";
    
    quizQuestions.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "quiz-item";
        div.innerHTML = `
            <div class="quiz-question">${index + 1}. ${item.q}</div>
            <div class="quiz-options">
                <label><input type="radio" name="q${index}" value="true"> Î£Ï‰ÏƒÏ„ÏŒ</label>
                <label><input type="radio" name="q${index}" value="false"> Î›Î¬Î¸Î¿Ï‚</label>
            </div>
            <div class="quiz-feedback" id="feedback-q${index}"></div>
        `;
        container.appendChild(div);
    });
  }

  function checkQuiz() {
    let score = 0;
    let answered = 0;
    
    quizQuestions.forEach((item, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const feedback = document.getElementById(`feedback-q${index}`);
        
        if (selected) {
            answered++;
            const userAns = (selected.value === 'true');
            if (userAns === item.a) {
                score++;
                feedback.innerHTML = '<span class="correct-text">âœ“ Î£Ï‰ÏƒÏ„ÏŒ!</span>';
            } else {
                feedback.innerHTML = '<span class="wrong-text">âœ— Î›Î¬Î¸Î¿Ï‚.</span>';
            }
        } else {
            feedback.innerHTML = '<span class="wrong-text">Î”ÎµÎ½ Î±Ï€Î±Î½Ï„Î®Î¸Î·ÎºÎµ.</span>';
        }
    });
    
    const resultDiv = document.getElementById("quiz-result");
    resultDiv.style.display = "block";
    resultDiv.innerHTML = `<strong>Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±:</strong> ${score} / ${quizQuestions.length}`;
    
    if (score === quizQuestions.length) {
        resultDiv.style.background = "linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)";
        resultDiv.style.borderColor = "#81c784";
    } else {
        resultDiv.style.background = "linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%)";
        resultDiv.style.borderColor = "#ffb74d";
    }
  }

  function resetQuiz() {
    document.querySelectorAll('input[type="radio"]').forEach(rb => rb.checked = false);
    document.querySelectorAll('.quiz-feedback').forEach(div => div.innerHTML = "");
    document.getElementById("quiz-result").style.display = "none";
  }

  // ====== Tabs & Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ======
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".tab-button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".tab-button").forEach(b => b.classList.remove("active"));
        document.querySelectorAll(".panel").forEach(p => p.classList.remove("active"));
        btn.classList.add("active");
        const target = btn.getAttribute("data-target");
        document.getElementById(target).classList.add("active");
      });
    });

    // Î±ÏÏ‡Î¹ÎºÎ® RAM Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î´Î¿Î¼Î­Ï‚
    resetMemory(singlyState);
    resetMemory(doublyState);
    resetMemory(stackState);
    resetMemory(queueState);
    
    // Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Quiz
    renderQuiz();
    document.getElementById("btn-check-quiz").addEventListener("click", checkQuiz);
    document.getElementById("btn-reset-quiz").addEventListener("click", resetQuiz);

    // events Î»Î¹ÏƒÏ„ÏÎ½
    document.getElementById("singly-init").addEventListener("click", singlyInitList);
    document.getElementById("singly-insert").addEventListener("click", singlyInsertNode);
    document.getElementById("singly-delete").addEventListener("click", singlyDeleteNode);
    document.getElementById("singly-clear").addEventListener("click", singlyClear);

    document.getElementById("doubly-init").addEventListener("click", doublyInitList);
    document.getElementById("doubly-insert").addEventListener("click", doublyInsertNode);
    document.getElementById("doubly-delete").addEventListener("click", doublyDeleteNode);
    document.getElementById("doubly-clear").addEventListener("click", doublyClear);

    // ÏƒÏ„Î¿Î¯Î²Î±
    document.getElementById("stack-init").addEventListener("click", stackInit);
    document.getElementById("stack-push").addEventListener("click", stackPush);
    document.getElementById("stack-pop").addEventListener("click", stackPop);
    document.getElementById("stack-clear").addEventListener("click", stackClear);

    // Î¿Ï…ÏÎ¬
    document.getElementById("queue-init").addEventListener("click", queueInit);
    document.getElementById("queue-enqueue").addEventListener("click", queueEnqueue);
    document.getElementById("queue-dequeue").addEventListener("click", queueDequeue);
    document.getElementById("queue-clear").addEventListener("click", queueClear);

    // ÎµÏ€Î¹Î»Î¿Î³Î® ÎºÏŒÎ¼Î²Ï‰Î½ (click) Î³Î¹Î± Î±Ï€Î»Î® & Î´Î¹Ï€Î»Î® Î»Î¯ÏƒÏ„Î±
    document.getElementById("singly-visual").addEventListener("click", e => {
      const node = e.target.closest(".node");
      if (!node) return;
      const addr = parseInt(node.dataset.addr, 10);
      singlyState.selected = addr;
      singlyRenderAll();
    });

    document.getElementById("doubly-visual").addEventListener("click", e => {
      const node = e.target.closest(".node");
      if (!node) return;
      const addr = parseInt(node.dataset.addr, 10);
      doublyState.selected = addr;
      doublyRenderAll();
    });

    // Î±ÏÏ‡Î¹ÎºÏŒ render
    singlyRenderAll();
    doublyRenderAll();
    stackRenderAll();
    queueRenderAll();
  });
</script>
</body>
</html>
